# Code generated by skv2. DO NOT EDIT.

apiVersion: apiextensions.k8s.io/v1beta1
kind: CustomResourceDefinition
metadata:
  labels:
    app: gloo-mesh
    app.kubernetes.io/name: gloo-mesh
  name: wasmdeployments.networking.enterprise.mesh.gloo.solo.io
spec:
  group: networking.enterprise.mesh.gloo.solo.io
  names:
    kind: WasmDeployment
    listKind: WasmDeploymentList
    plural: wasmdeployments
    singular: wasmdeployment
  preserveUnknownFields: false
  scope: Namespaced
  subresources:
    status: {}
  validation:
    openAPIV3Schema:
      properties:
        spec:
          description: Deploys one or more WASM Envoy Filters to selected Sidecars
            and Gateways in a Mesh.
          properties:
            filters:
              description: Specify WASM filter parameters.
              items:
                allOf:
                - oneOf:
                  - not:
                      anyOf:
                      - required:
                        - localPathSource
                      - required:
                        - httpUriSource
                      - required:
                        - wasmImageSource
                  - required:
                    - localPathSource
                  - required:
                    - httpUriSource
                  - required:
                    - wasmImageSource
                - oneOf:
                  - not:
                      anyOf:
                      - required:
                        - staticFilterConfig
                      - required:
                        - dynamicFilterConfig
                  - required:
                    - staticFilterConfig
                  - required:
                    - dynamicFilterConfig
                properties:
                  dynamicFilterConfig:
                    description: |-
                      Provide configuration from a dynamic configuration source.
                      This is used to connect proxies to a user-provided configuration server
                      rather than using the WasmDeployment CR to update filter configuration.
                      NOTE: Not currently implemented. This field serves as a placeholder.
                      passing it to the plugin. `google.protobuf.BytesValue` and
                      `google.protobuf.StringValue` are passed directly without the wrapper.
                      TODO(ilackarms): implement with dynamic filter config source (FCDS) https://github.com/envoyproxy/envoy/issues/7867
                    type: string
                  filterContext:
                    description: |-
                      The specific config generation context to which to attach the filter. Istio
                      generates envoy configuration in the context of a gateway,
                      inbound traffic to sidecar and outbound traffic from sidecar.
                      Uses the Istio default (`ANY`).
                    enum:
                    - ANY
                    - SIDECAR_INBOUND
                    - SIDECAR_OUTBOUND
                    - GATEWAY
                    type: string
                  httpUriSource:
                    description: |-
                      Select `http_uri_source` to deploy the filter from an HTTP/S URI accessible
                      to the workload proxy. Note that Gloo Mesh cannot verify
                      whether the target workload proxy containers have HTTP access the given URI.
                      If filters do not load, please inspect the sidecar proxy logs.
                      TODO(ilackarms): see if we can somehow verify the filter exists in the proxy container and surface that on the WasmDeployment status
                      TODO(ilackarms): we may need to provide options for customizing the Cluster given to envoy along with the HTTP Fetch URI. currently Gloo Mesh will create a simple plaintext HTTP cluster from the Host/Port specified in the URI.
                    properties:
                      sha:
                        description: Required. The Sha256 Checksum of the filter binary
                          (will be verified by the proxy).
                        type: string
                      uri:
                        description: The HTTP URI from which to fetch the filter.
                        type: string
                    type: object
                  insertBeforeFilter:
                    description: |-
                      The filter in the Envoy HTTP Filter Chain immediately before which the WASM filter will be
                      inserted.
                      Defaults to `envoy.router`.
                    type: string
                  localPathSource:
                    description: |-
                      Select `local_path_source` to deploy the filter from a file accessible
                      to the workload proxy. Note that Gloo Mesh cannot verify
                      whether the target workload proxy containers contain the given path.
                      If filters do not load, please inspect the sidecar proxy logs.
                      TODO(ilackarms): see if we can somehow verify the filter exists in the proxy container and surface that on the WasmDeployment status
                    type: string
                  rootId:
                    description: |-
                      The `root id` must match the `root id` defined inside the filter.
                      If the user does not provide this field, Gloo Mesh will attempt to pull the image
                      and set it from the `filter_conf` contained in the image config.
                      Note that if the `filter_source` is not set to `wasm_image_source`, this field is required.
                    type: string
                  staticFilterConfig:
                    description: |-
                      Provide configuration as a static
                      `google.protobuf.Struct` is serialized as JSON before
                      passing it to the plugin. `google.protobuf.BytesValue` and
                      `google.protobuf.StringValue` are passed directly without the wrapper.
                    type: object
                    x-kubernetes-preserve-unknown-fields: true
                  vmId:
                    description: |-
                      An ID which will be used along with a hash of the wasm code
                      (or the name of the registered Null VM plugin) to determine which VM will be used to load the WASM filter.
                      All filters on the same proxy which use the same `vm_id` and code within will use the same VM.
                      May be left blank. Sharing a VM between plugins can reduce memory utilization and make sharing of data easier which may have security implications.
                    type: string
                  wasmImageSource:
                    description: |-
                      fetch the image from a [WASM OCI Registry](https://webassemblyhub.io/)
                      Images can be built and pushed to registries using `meshctl` and `wasme`.
                    properties:
                      wasmImageTag:
                        description: The full tag of the wasm image. It must include
                          the registry address at the beginning, e.g. "webassemblyhub.io/ilackarms/helloworld:v0.1".
                        type: string
                    type: object
                type: object
              type: array
            weight:
              description: |-
                Weight is used to determine the order of WASM Filters when applying
                multiple WasmDeployments to a single workload.
                Deployed WASM filters will be sorted in order of
                highest to lowest weight. WasmDeployments with equal weights will be
                sorted non-deterministically.
                Note that all WASM Filters are currently inserted just before the Envoy router filter
                in the HTTP Connection Manager's HTTP Filter Chain.
              maximum: 4294967295
              minimum: 0
              type: integer
            workloadSelector:
              description: |-
                Sidecars/Gateways whose Workloads match these selectors will attach the specified WASM Filters.
                Leave empty to have all workloads in the mesh apply receive the WASM Filter.
              items:
                properties:
                  kubeWorkloadMatcher:
                    description: Match Kubernetes workloads by their labels, namespaces,
                      and/or clusters.
                    properties:
                      clusters:
                        description: |-
                          If specified, match Kubernetes workloads if they exist in one of the specified clusters.
                                     When used in a networking policy, omission matches any cluster.
                                     When used in a Gloo Mesh Role, a wildcard (`"*"`) must be specified to match any cluster.
                        items:
                          type: string
                        type: array
                      labels:
                        additionalProperties:
                          type: string
                        description: |-
                          If specified, all labels must exist on Kubernetes workload.
                                 When used in a networking policy, omission matches any labels.
                                 When used in a Gloo Mesh Role, a wildcard (`"*"`) must be specified to match any label key and/or value.
                        type: object
                      namespaces:
                        description: |-
                          If specified, match Kubernetes workloads if they exist in one of the specified namespaces.
                                     When used in a networking policy, omission matches any namespace.
                                     When used in a Gloo Mesh Role, a wildcard (`"*"`) must be specified to match any namespace.
                        items:
                          type: string
                        type: array
                    type: object
                type: object
              type: array
          type: object
        status:
          properties:
            error:
              description: |-
                Any errors encountered while processing this generation of the resource.
                This can include failures to pull a WASM image as well as missing or invalid
                fields in the spec.
              type: string
            observedGeneration:
              description: |-
                The most recent generation observed in the the WasmDeployment metadata.
                if the observedGeneration does not match `metadata.generation`, Gloo Mesh has not processed the most
                recent version of this resource.
              format: int64
              type: integer
            workloadStates:
              additionalProperties:
                enum:
                - DEPLOYMENT_PENDING
                - FILTERS_DEPLOYED
                - DEPLOYMENT_FAILED
                type: string
              description: The state of the WasmDeployment as it has been applied
                to each individual Workload.
              type: object
          type: object
      type: object
  versions:
  - name: v1beta1
    served: true
    storage: true

---
apiVersion: apiextensions.k8s.io/v1beta1
kind: CustomResourceDefinition
metadata:
  labels:
    app: gloo-mesh
    app.kubernetes.io/name: gloo-mesh
  name: ratelimiterserverconfigs.networking.enterprise.mesh.gloo.solo.io
spec:
  group: networking.enterprise.mesh.gloo.solo.io
  names:
    kind: RateLimiterServerConfig
    listKind: RateLimiterServerConfigList
    plural: ratelimiterserverconfigs
    singular: ratelimiterserverconfig
  preserveUnknownFields: false
  scope: Namespaced
  subresources:
    status: {}
  validation:
    openAPIV3Schema:
      properties:
        spec:
          description: |-
            RateLimiterConfig contains the configuration for the Gloo Rate Limiter, the external rate-limiting server used by
            mesh proxies to rate-limit HTTP requests. One or more rate limiter servers may be deployed in order to
            rate limit traffic across East-West and North-South routes. The RateLimiterConfig allows users to map
            a single rate-limiter configuration to multiple rate-limiter server instances, deployed across managed clusters.
          properties:
            rateLimitConfig:
              description: |-
                the configuration which will be deployed to the selected rate limit servers.
                TODO: move disable validation annotation into solo-apis
              type: object
              x-kubernetes-preserve-unknown-fields: true
            serverConfigRefs:
              description: |-
                The per-server rate limit config objects will be generated from the given config for each provided ref.
                Each rate limit server must be configured to read its server configuration from one of these refs.
              items:
                properties:
                  name:
                    description: name of the resource being referenced
                    type: string
                  namespace:
                    description: namespace of the resource being referenced
                    type: string
                type: object
              type: array
          type: object
        status:
          description: The current status of the `RateLimitConfig`.
          properties:
            configuredServers:
              description: a list of rate limit server workloads which have been configured
                with this RateLimiterConfig
              items:
                properties:
                  clusterName:
                    description: name of the cluster in which the resource exists
                    type: string
                  name:
                    description: name of the resource being referenced
                    type: string
                  namespace:
                    description: namespace of the resource being referenced
                    type: string
                type: object
              type: array
            errors:
              description: Any errors found while processing this generation of the
                resource.
              items:
                type: string
              type: array
            observedGeneration:
              description: |-
                The most recent generation observed in the the RateLimiterServerConfig metadata.
                If the `observedGeneration` does not match `metadata.generation`,
                Gloo Mesh has not processed the most recent version of this resource.
              format: int64
              type: integer
            warnings:
              description: Any warnings found while processing this generation of
                the resource.
              items:
                type: string
              type: array
          type: object
      type: object
  versions:
  - name: v1beta1
    served: true
    storage: true

---
apiVersion: apiextensions.k8s.io/v1beta1
kind: CustomResourceDefinition
metadata:
  labels:
    app: gloo-mesh
    app.kubernetes.io/name: gloo-mesh
  name: virtualdestinations.networking.enterprise.mesh.gloo.solo.io
spec:
  group: networking.enterprise.mesh.gloo.solo.io
  names:
    kind: VirtualDestination
    listKind: VirtualDestinationList
    plural: virtualdestinations
    singular: virtualdestination
  preserveUnknownFields: false
  scope: Namespaced
  subresources:
    status: {}
  validation:
    openAPIV3Schema:
      properties:
        spec:
          allOf:
          - oneOf:
            - not:
                anyOf:
                - required:
                  - virtualMesh
                - required:
                  - meshList
            - required:
              - virtualMesh
            - required:
              - meshList
          - oneOf:
            - not:
                anyOf:
                - required:
                  - static
                - required:
                  - localized
            - required:
              - static
            - required:
              - localized
          description: |-
            A VirtualDestination creates a new hostname to which client workloads can send requests.
               The hostname abstracts over a set of underlying Destinations and provides failover functionality between them.
               Failover order is determined by either an explicitly defined priority (`static`), or a list of locality directives (`localized`).

               Each Destination backing the VirtualDestination must be configured with a
               [TrafficPolicy's outlier detection]({{< versioned_link_path fromRoot="/reference/api/github.com.solo-io.gloo-mesh.api.networking.v1.traffic_policy/" >}}).
               Currently this feature only supports Destinations backed by Istio.
          properties:
            hostname:
              description: The DNS name of the VirtualDestination. Must be unique
                within the service mesh instance.
              type: string
            localized:
              description: Failover priority is determined by the localities of the
                traffic source and Destination.
              properties:
                destinationSelectors:
                  description: |-
                    Selectors for the Destinations backing the VirtualDestination.
                    All Destinations must be either in the same mesh or in meshes that are grouped under a common VirtualMesh.
                    Currently only one Destination per cluster can be selected, more than one per cluster will be considered invalid.
                    Required, cannot be omitted.
                  items:
                    properties:
                      kubeServiceMatcher:
                        description: Match Kubernetes Services by their labels, namespaces,
                          and/or clusters.
                        properties:
                          clusters:
                            description: |-
                              If specified, match Kubernetes Services if they exist in one of the specified clusters.
                                         When used in a networking policy, omission matches any cluster.
                                         When used in a Gloo Mesh Role, a wildcard (`"*"`) must be specified to match any cluster.
                            items:
                              type: string
                            type: array
                          labels:
                            additionalProperties:
                              type: string
                            description: |-
                              If specified, a match requires all labels to exist on a Kubernetes Service.
                                         When used in a networking policy, omission matches any labels.
                                         When used in a Gloo Mesh Role, a wildcard (`"*"`) must be specified to match any label key and/or value.
                            type: object
                          namespaces:
                            description: |-
                              If specified, match Kubernetes Services if they exist in one of the specified namespaces.
                                         When used in a networking policy, omission matches any namespace.
                                         When used in a Gloo Mesh Role, a wildcard (`"*"`) must be specified to match any namespace.
                            items:
                              type: string
                            type: array
                        type: object
                      kubeServiceRefs:
                        description: Match Kubernetes Services by direct reference.
                        properties:
                          services:
                            description: |-
                              Match Kubernetes Services by direct reference. All fields are required.
                                         When used in a Gloo Mesh Role, a wildcard (`"*"`) must be specified to match any value for the given field.
                            items:
                              properties:
                                clusterName:
                                  description: name of the cluster in which the resource
                                    exists
                                  type: string
                                name:
                                  description: name of the resource being referenced
                                  type: string
                                namespace:
                                  description: namespace of the resource being referenced
                                  type: string
                              type: object
                            type: array
                        type: object
                    type: object
                  type: array
                failoverDirectives:
                  description: Directives describing the locality failover behavior.
                  items:
                    properties:
                      from:
                        description: The locality of the client workload.
                        properties:
                          region:
                            description: The locality's region.
                            type: string
                          subZone:
                            description: The locality's sub-zone. Currently this value
                              is not used.
                            type: string
                          zone:
                            description: The locality's zone. Currently this value
                              is not used.
                            type: string
                        type: object
                      to:
                        description: The list of Destination localities that can be
                          routed to if the instance local to the client workload is
                          not available.
                        items:
                          properties:
                            region:
                              description: The locality's region.
                              type: string
                            subZone:
                              description: The locality's sub-zone. Currently this
                                value is not used.
                              type: string
                            zone:
                              description: The locality's zone. Currently this value
                                is not used.
                              type: string
                          type: object
                        type: array
                    type: object
                  type: array
                outlierDetection:
                  description: |-
                    Outlier detection to determine the health of the selected services.
                    If not set will default to the following:
                    consecutiveGatewayErrors: 10
                    consecutive5XXErrors: 10
                    interval: 5s
                    baseEjectionTime: 120s
                  properties:
                    baseEjectionTime:
                      description: 'The minimum ejection duration. Format: `1h`/`1m`/`1s`/`1ms`.
                        Must be >= `1ms`. A default will be used if not set.'
                      type: string
                    consecutiveErrors:
                      description: The number of errors before a host is ejected from
                        the connection pool. A default will be used if not set.
                      maximum: 4294967295
                      minimum: 0
                      type: integer
                    interval:
                      description: 'The time interval between ejection sweep analysis.
                        Format: `1h`/`1m`/`1s`/`1ms`. Must be >= `1ms`. A default
                        will be used if not set.'
                      type: string
                    maxEjectionPercent:
                      description: |-
                        The maximum percentage of hosts that can be ejected from the load balancing pool.
                        At least one host will be ejected regardless of the value. Must be between 0 and 100. A default will be used if not set.
                      maximum: 4294967295
                      minimum: 0
                      type: integer
                  type: object
              type: object
            meshList:
              description: |-
                The Meshes that this VirtualDestination will be visible to. If multiple meshes are specified, they must
                all belong to the same VirtualMesh.
              properties:
                meshes:
                  items:
                    properties:
                      name:
                        description: name of the resource being referenced
                        type: string
                      namespace:
                        description: namespace of the resource being referenced
                        type: string
                    type: object
                  type: array
              type: object
            port:
              description: The port on which the VirtualDestination listens.
              oneOf:
              - not:
                  anyOf:
                  - required:
                    - targetName
                  - required:
                    - targetNumber
              - required:
                - targetName
              - required:
                - targetNumber
              properties:
                number:
                  description: 'REQUIRED: Port number which the VirtualDestination
                    will listen on.'
                  maximum: 4294967295
                  minimum: 0
                  type: integer
                protocol:
                  description: |-
                    OPTIONAL: Protocol of the requests sent to the VirtualDestination. Must be one of `HTTP`, `HTTPS`, `GRPC`, `HTTP2`, `MONGO`, `TCP`, `TLS`.
                    Default: HTTP
                  type: string
                targetName:
                  description: If the target_name is specified, the VirtualDestination
                    will attempt to find a port by this name on all backing services
                  type: string
                targetNumber:
                  description: If the target_number is specified, the VirtualDestination
                    will attempt to find a port by this number on all backing services
                  maximum: 4294967295
                  minimum: 0
                  type: integer
              type: object
            static:
              description: Failover priority is determined by an explicitly provided
                static ordering of Destinations.
              properties:
                destinations:
                  description: |-
                    The list of Destinations backing the VirtualDestination, ordered by decreasing priority.
                    All Destinations must be either in the same Mesh or in Meshes that are grouped under a common VirtualMesh.
                    Required, cannot be omitted.
                  items:
                    oneOf:
                    - not:
                        anyOf:
                        - required:
                          - kubeService
                    - required:
                      - kubeService
                    properties:
                      kubeService:
                        description: Reference to a Kubernetes Service.
                        properties:
                          clusterName:
                            description: name of the cluster in which the resource
                              exists
                            type: string
                          name:
                            description: name of the resource being referenced
                            type: string
                          namespace:
                            description: namespace of the resource being referenced
                            type: string
                        type: object
                    type: object
                  type: array
              type: object
            virtualMesh:
              description: The VirtualMesh that this VirtualDestination will be visible
                to.
              properties:
                name:
                  description: name of the resource being referenced
                  type: string
                namespace:
                  description: namespace of the resource being referenced
                  type: string
              type: object
          type: object
        status:
          properties:
            errors:
              description: Any errors found while processing this generation of the
                resource.
              items:
                type: string
              type: array
            meshes:
              additionalProperties:
                properties:
                  acceptanceOrder:
                    description: |-
                      Represents the order in which the policy
                      was accepted and applied to a discovery resource. The first accepted policy
                      will have an acceptance_order of 0, the second 1, etc.
                      When conflicts are detected in the system,
                      the Policy with the lowest acceptance_order
                      will be chosen and all other conflicting policies will be rejected.
                    maximum: 4294967295
                    minimum: 0
                    type: integer
                  errors:
                    description: Any errors observed which prevented the resource
                      from being Accepted.
                    items:
                      type: string
                    type: array
                  state:
                    description: The result of attempting to apply the policy to the
                      discovery resource.
                    enum:
                    - PENDING
                    - ACCEPTED
                    - INVALID
                    - FAILED
                    type: string
                  warnings:
                    description: Any warnings observed while processing the resource.
                    items:
                      type: string
                    type: array
                type: object
              description: The status of the VirtualDestination for each Mesh to which
                it has been exported to.
              type: object
            observedGeneration:
              description: |-
                The most recent generation observed in the the VirtualDestination metadata.
                If the observedGeneration does not match `metadata.generation`, Gloo Mesh has not processed the most
                recent version of this resource.
              format: int64
              type: integer
            requiredSubsets:
              description: The set of TrafficPolicies that reference subsets on this
                VirtualDestination as a traffic shift.
              items:
                properties:
                  observedGeneration:
                    description: The observed generation of the TrafficPolicy.
                    format: int64
                    type: integer
                  trafficPolicyRef:
                    description: Reference to the TrafficPolicy object.
                    properties:
                      name:
                        description: name of the resource being referenced
                        type: string
                      namespace:
                        description: namespace of the resource being referenced
                        type: string
                    type: object
                  trafficShift:
                    description: The applied traffic shift.
                    properties:
                      destinations:
                        description: Specify weighted traffic shift destinations.
                        items:
                          oneOf:
                          - not:
                              anyOf:
                              - required:
                                - kubeService
                              - required:
                                - virtualDestination
                              - required:
                                - staticDestination
                              - required:
                                - clusterHeader
                          - required:
                            - kubeService
                          - required:
                            - virtualDestination
                          - required:
                            - staticDestination
                          - required:
                            - clusterHeader
                          properties:
                            clusterHeader:
                              description: |-
                                Envoy will determine the cluster to route to by reading the value of the HTTP header named by cluster_header from the request headers.
                                If the header is not found or the referenced cluster does not exist, Envoy will return a 404 response.
                                Avoid using this whenever possible, it does not allow for custom filter configuration based on Virtual Host.
                                {{/* NOTE: unimplemented */}}
                              type: string
                            kubeService:
                              description: Specify a Kubernetes Service.
                              properties:
                                clusterName:
                                  description: The Gloo Mesh cluster name (registration
                                    name) of the service.
                                  type: string
                                name:
                                  description: The name of the service.
                                  type: string
                                namespace:
                                  description: The namespace of the service.
                                  type: string
                                port:
                                  description: Port on the service to receive traffic.
                                    Required if the service exposes more than one
                                    port.
                                  maximum: 4294967295
                                  minimum: 0
                                  type: integer
                                subset:
                                  additionalProperties:
                                    type: string
                                  description: Specify, by labels, a subset of service
                                    instances to route to.
                                  type: object
                              type: object
                            options:
                              description: |-
                                additional options / config for a route which will be applied
                                when this destination is selected.
                              properties:
                                headerManipulation:
                                  description: manipualte headers on traffic sent
                                    to this destination
                                  properties:
                                    appendRequestHeaders:
                                      additionalProperties:
                                        type: string
                                      description: Additional HTTP headers to add
                                        before forwarding a request to the destination
                                        service.
                                      type: object
                                    appendResponseHeaders:
                                      additionalProperties:
                                        type: string
                                      description: Additional HTTP headers to add
                                        before returning a response to the caller.
                                      type: object
                                    removeRequestHeaders:
                                      description: HTTP headers to remove before forwarding
                                        a request to the destination service.
                                      items:
                                        type: string
                                      type: array
                                    removeResponseHeaders:
                                      description: HTTP headers to remove before returning
                                        a response to the caller.
                                      items:
                                        type: string
                                      type: array
                                  type: object
                              type: object
                            staticDestination:
                              description: Reference to a gloo mesh Static Destination
                              properties:
                                name:
                                  description: name of the resource being referenced
                                  type: string
                                namespace:
                                  description: namespace of the resource being referenced
                                  type: string
                              type: object
                            virtualDestination:
                              description: Specify a VirtualDestination.
                              properties:
                                name:
                                  description: The name of the VirtualDestination
                                    object.
                                  type: string
                                namespace:
                                  description: The namespace of the VirtualDestination
                                    object.
                                  type: string
                                subset:
                                  additionalProperties:
                                    type: string
                                  description: Specify, by labels, a subset of service
                                    instances backing the VirtualDestination to route
                                    to.
                                  type: object
                              type: object
                            weight:
                              description: |-
                                Specify the proportion of traffic to be forwarded to this destination.
                                Weights across all of the `destinations` must sum to 100.
                              maximum: 4294967295
                              minimum: 0
                              type: integer
                          type: object
                        type: array
                    type: object
                type: object
              type: array
            selectedDestinations:
              description: The Destinations that comprise this VirtualDestination.
              items:
                properties:
                  destination:
                    description: The platform-specific destination that the Destination
                      object represents.
                    oneOf:
                    - not:
                        anyOf:
                        - required:
                          - kubeService
                    - required:
                      - kubeService
                    properties:
                      kubeService:
                        description: Reference to a Kubernetes Service.
                        properties:
                          clusterName:
                            description: name of the cluster in which the resource
                              exists
                            type: string
                          name:
                            description: name of the resource being referenced
                            type: string
                          namespace:
                            description: namespace of the resource being referenced
                            type: string
                        type: object
                    type: object
                  ref:
                    description: Reference to the Destination object.
                    properties:
                      clusterName:
                        description: name of the cluster in which the resource exists
                        type: string
                      name:
                        description: name of the resource being referenced
                        type: string
                      namespace:
                        description: namespace of the resource being referenced
                        type: string
                    type: object
                type: object
              type: array
            state:
              description: |-
                The state of the overall resource, will only show accepted if it has been successfully
                applied to all exported to Meshes.
              enum:
              - PENDING
              - ACCEPTED
              - INVALID
              - FAILED
              type: string
          type: object
      type: object
  versions:
  - name: v1beta1
    served: true
    storage: true

---
apiVersion: apiextensions.k8s.io/v1beta1
kind: CustomResourceDefinition
metadata:
  labels:
    app: gloo-mesh
    app.kubernetes.io/name: gloo-mesh
  name: virtualgateways.networking.enterprise.mesh.gloo.solo.io
spec:
  group: networking.enterprise.mesh.gloo.solo.io
  names:
    kind: VirtualGateway
    listKind: VirtualGatewayList
    plural: virtualgateways
    singular: virtualgateway
  preserveUnknownFields: false
  scope: Namespaced
  subresources:
    status: {}
  validation:
    openAPIV3Schema:
      properties:
        spec:
          description: |-
            VirtualGateway is the top-level object for configuring ingress into a Mesh or VirtualMesh.
               A single VirtualGateway can apply to multiple deployed ingress pods and sidecars across meshes and clusters contained within a VirtualMesh.
               VirtualGateways can route traffic to destination services which live in a specific cluster or mesh.
               This allows VirtualGateways to route traffic from an ingress or sidecar in one mesh to a service in another. In order to
               perform cross-mesh routing, the Gateway Mesh and Destination mesh must be contained in a single VirtualMesh, with federation enabled.
          properties:
            connectionHandlers:
              description: |-
                Each Gateway must implement one or more ConnectionHandlers.
                A ConnectionHandler instructs the gateway how to handle clients
                which have connected to the specified bind address.
                Typically `connectionHandlers` will consist of a single `http` handler
                which serves HTTP Routes defined in a set of VirtualHosts.
                Multiple `connectionHandlers` can be specified to provide different behavior
                on the same Gateway, e.g. one for TCP and one for HTTP traffic.
              items:
                oneOf:
                - not:
                    anyOf:
                    - required:
                      - http
                    - required:
                      - tcp
                - required:
                  - http
                - required:
                  - tcp
                properties:
                  connectionMatch:
                    description: |-
                      Additional options for matching a connection to a specific gateway.
                      This is required when more than one `connectionHandler` is specified for a single gateway.
                      Typically this is used to serve different
                    properties:
                      serverNames:
                        description: |-
                          If non-empty, a list of server names (e.g. SNI for TLS protocol) to consider when determining
                          a `connectionMatch`. Those values will be compared against the server names of a new
                          connection, when detected by one of the listener filters.

                          The server name will be matched against all wildcard domains, i.e. `www.example.com`
                          will be first matched against `www.example.com`, then `*.example.com`, then ``*.com`.

                          Note that partial wildcards are not supported, and values like `*w.example.com` are invalid.
                        items:
                          type: string
                        type: array
                      transportProtocol:
                        description: Protocol
                        type: string
                    type: object
                  connectionOptions:
                    description: Top level optional configuration for all routes on
                      the ConnectionHandler.
                    properties:
                      enableProxyProtocol:
                        description: enable PROXY protocol for this connection handler.
                        type: boolean
                      strictFilterManagement:
                        description: |-
                          Restricts filter from being added to the corresponding Envoy Listener unless they are explicitly configured
                          in the connection handler options
                        type: boolean
                      tlsContext:
                        description: TODO
                        properties:
                          presented:
                            description: |-
                              If specified, the route will match against whether or not a certificate is presented.
                              If not specified, certificate presentation status (true or false) will not be considered when route matching.
                            nullable: true
                            type: boolean
                          validated:
                            description: |-
                              If specified, the route will match against whether or not a certificate is validated.
                              If not specified, certificate validation status (true or false) will not be considered when route matching.
                            nullable: true
                            type: boolean
                        type: object
                    type: object
                  http:
                    properties:
                      routeConfig:
                        items:
                          oneOf:
                          - not:
                              anyOf:
                              - required:
                                - virtualHostSelector
                              - required:
                                - virtualHost
                          - required:
                            - virtualHostSelector
                          - required:
                            - virtualHost
                          properties:
                            virtualHost:
                              description: |-
                                VirtualHost allows in-lining a route table directly in the Gateway Resource, for simple configs using fewer CRDs.
                                Note that Kubernetes admission validation of inline virtual hosts is disabled. For production, the use of `virtualHostSelector` is recommended.
                              type: object
                              x-kubernetes-preserve-unknown-fields: true
                            virtualHostSelector:
                              description: RouteSelector is used to specify which
                                VirtualHosts should be attached to this gateway.
                              properties:
                                expressions:
                                  description: |-
                                    Expressions allow for more flexible object label matching, such as equality-based requirements, set-based requirements, or a combination of both.
                                    https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/#equality-based-requirement
                                  items:
                                    properties:
                                      key:
                                        description: |-
                                          Kubernetes label key, must conform to Kubernetes syntax requirements
                                          https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/#syntax-and-character-set
                                        type: string
                                      operator:
                                        description: The operator can only be in,
                                          notin, =, ==, !=, exists, ! (DoesNotExist),
                                          gt (GreaterThan), lt (LessThan).
                                        enum:
                                        - Equals
                                        - DoubleEquals
                                        - NotEquals
                                        - In
                                        - NotIn
                                        - Exists
                                        - DoesNotExist
                                        - GreaterThan
                                        - LessThan
                                        type: string
                                      values:
                                        items:
                                          type: string
                                        type: array
                                    type: object
                                  type: array
                                labels:
                                  additionalProperties:
                                    type: string
                                  description: Select objects whose labels match the
                                    ones specified here.
                                  type: object
                                namespaces:
                                  description: |-
                                    Select Objects in these namespaces. If omitted, Gloo Mesh will only select Objects in the same namespace
                                    as the parent resource (e.g. VirtualGateway) that owns this selector.
                                    The reserved value "*" can be used to select objects in all namespaces watched by Gloo Mesh.
                                  items:
                                    type: string
                                  type: array
                              type: object
                          type: object
                        type: array
                      routeOptions:
                        description: HTTP Listener Options // Root level RouteTable
                          + VirtualHost + routes level
                        properties:
                          csrf:
                            description: Configure Global CSRF options for clients
                              connected to this Gateway.
                            properties:
                              additionalOrigins:
                                description: |-
                                  Specifies additional source origins that will be allowed in addition to
                                  the destination origin.
                                items:
                                  oneOf:
                                  - not:
                                      anyOf:
                                      - required:
                                        - exact
                                      - required:
                                        - prefix
                                      - required:
                                        - regex
                                      - required:
                                        - suffix
                                  - required:
                                    - exact
                                  - required:
                                    - prefix
                                  - required:
                                    - regex
                                  - required:
                                    - suffix
                                  properties:
                                    exact:
                                      description: Exact string match.
                                      type: string
                                    ignoreCase:
                                      description: If true, indicates the exact/prefix/suffix
                                        matching should be case insensitive. This
                                        has no effect for the regex match.
                                      type: boolean
                                    prefix:
                                      description: Prefix-based match.
                                      type: string
                                    regex:
                                      description: ECMAscript style regex-based match.
                                      type: string
                                    suffix:
                                      description: Suffix-based match.
                                      type: string
                                  type: object
                                type: array
                              filterEnabled:
                                description: Specifies that CSRF policies will be
                                  evaluated, tracked and enforced.
                                type: boolean
                              percentage:
                                description: |-
                                  Specifies the % of requests for which the CSRF filter is enabled or when shadow mode is enabled the % of requests
                                  evaluated and tracked, but not enforced.

                                  If filter_enabled or shadow_enabled is true.
                                  Envoy will lookup the runtime key to get the percentage of requests to filter.

                                  .. note:: This field defaults to 100
                                format: double
                                type: number
                              shadowEnabled:
                                description: |-
                                  Specifies that CSRF policies will be evaluated and tracked, but not enforced.

                                  This is intended to be used when ``filter_enabled`` is false and will be ignored otherwise.
                                type: boolean
                            type: object
                          extauth:
                            description: Configure the Global Extauth options for
                              clients connected to this Gateway
                            properties:
                              todo:
                                description: 'TODO: extauth'
                                type: string
                            type: object
                          rateLimit:
                            description: |-
                              Configure Global Rate limit options for clients connected to this Gateway.
                              Rate limits must be configured on specific routes in order to enable rate limiting for a Gateway.
                            properties:
                              denyOnFail:
                                type: boolean
                              rateLimitBeforeAuth:
                                description: |-
                                  Set this is set to true if you would like to rate limit traffic before applying external auth to it.
                                  *Note*: When this is true, you will lose some features like being able to rate limit a request based on its auth state
                                type: boolean
                              ratelimitServerRef:
                                properties:
                                  name:
                                    description: name of the resource being referenced
                                    type: string
                                  namespace:
                                    description: namespace of the resource being referenced
                                    type: string
                                type: object
                              requestTimeout:
                                type: string
                            type: object
                        type: object
                    type: object
                  tcp:
                    properties:
                      options:
                        description: TCP Gateway configuration
                        properties:
                          tcpProxySettings:
                            properties:
                              idleTimeout:
                                type: string
                              maxConnectAttempts:
                                description: |-
                                  Contains various settings for Envoy's tcp proxy filter.
                                  See here for more information: https://www.envoyproxy.io/docs/envoy/v1.10.0/api-v2/config/filter/network/tcp_proxy/v2/tcp_proxy.proto#envoy-api-msg-config-filter-network-tcp-proxy-v2-tcpproxy
                                maximum: 4294967295
                                minimum: 0
                                nullable: true
                                type: integer
                              tunnelingConfig:
                                description: |-
                                  If set, this configures tunneling, e.g. configuration options to tunnel multiple TCP
                                  payloads over a shared HTTP tunnel. If this message is absent, the payload
                                  will be proxied upstream as per usual.
                                properties:
                                  hostname:
                                    description: The hostname to send in the synthesized
                                      CONNECT headers to the upstream proxy.
                                    type: string
                                type: object
                            type: object
                        type: object
                      tcpHosts:
                        description: TCP hosts that the gateway can route to
                        items:
                          properties:
                            destination:
                              oneOf:
                              - not:
                                  anyOf:
                                  - required:
                                    - static
                                  - required:
                                    - virtual
                                  - required:
                                    - kube
                                  - required:
                                    - forwardSniClusterName
                              - required:
                                - static
                              - required:
                                - virtual
                              - required:
                                - kube
                              - required:
                                - forwardSniClusterName
                              properties:
                                forwardSniClusterName:
                                  description: |-
                                    Forwards the request to a cluster name matching the TLS SNI name
                                    https://www.envoyproxy.io/docs/envoy/latest/api-v2/config/filter/network/sni_cluster/empty/sni_cluster
                                    Note: This filter will only work properly with TLS connections in which the upstream SNI domain is specified
                                  maxProperties: 0
                                  type: object
                                kube:
                                  description: |-
                                    Reference to a Kubernetes Service. Note that the service must exist in the same mesh or virtual mesh (with federation enabled) as
                                    each gateway workload which routes to this destination.
                                  properties:
                                    clusterName:
                                      description: name of the cluster in which the
                                        resource exists
                                      type: string
                                    name:
                                      description: name of the resource being referenced
                                      type: string
                                    namespace:
                                      description: namespace of the resource being
                                        referenced
                                      type: string
                                  type: object
                                static:
                                  description: Reference to a gloo mesh Static Destination
                                  properties:
                                    name:
                                      description: name of the resource being referenced
                                      type: string
                                    namespace:
                                      description: namespace of the resource being
                                        referenced
                                      type: string
                                  type: object
                                virtual:
                                  description: Reference to a gloo mesh VirtualDestination
                                  properties:
                                    name:
                                      description: name of the resource being referenced
                                      type: string
                                    namespace:
                                      description: namespace of the resource being
                                        referenced
                                      type: string
                                  type: object
                                weight:
                                  description: |-
                                    Relative weight of this destination to others in the same route.
                                    If omitted, all destinations in the route will be load balanced between evenly.
                                  maximum: 4294967295
                                  minimum: 0
                                  type: integer
                              type: object
                            name:
                              description: the logical name of the tcp host. names
                                must be unique for each tcp host within a listener
                              type: string
                            sslConfig:
                              description: If provided, the Gateway will serve TLS/SSL
                                traffic for this set of routes
                              oneOf:
                              - not:
                                  anyOf:
                                  - required:
                                    - secretRef
                                  - required:
                                    - sslFiles
                                  - properties:
                                      sds:
                                        oneOf:
                                        - not:
                                            anyOf:
                                            - required:
                                              - callCredentials
                                            - required:
                                              - clusterName
                                        - required:
                                          - callCredentials
                                        - required:
                                          - clusterName
                                    required:
                                    - sds
                              - required:
                                - secretRef
                              - required:
                                - sslFiles
                              - properties:
                                  sds:
                                    oneOf:
                                    - not:
                                        anyOf:
                                        - required:
                                          - callCredentials
                                        - required:
                                          - clusterName
                                    - required:
                                      - callCredentials
                                    - required:
                                      - clusterName
                                required:
                                - sds
                              properties:
                                alpnProtocols:
                                  description: |-
                                    Set Application Level Protocol Negotiation
                                    If empty, defaults to ["h2", "http/1.1"].
                                  items:
                                    type: string
                                  type: array
                                parameters:
                                  properties:
                                    cipherSuites:
                                      items:
                                        type: string
                                      type: array
                                    ecdhCurves:
                                      items:
                                        type: string
                                      type: array
                                    maximumProtocolVersion:
                                      enum:
                                      - TLS_AUTO
                                      - TLSv1_0
                                      - TLSv1_1
                                      - TLSv1_2
                                      - TLSv1_3
                                      type: string
                                    minimumProtocolVersion:
                                      enum:
                                      - TLS_AUTO
                                      - TLSv1_0
                                      - TLSv1_1
                                      - TLSv1_2
                                      - TLSv1_3
                                      type: string
                                  type: object
                                sds:
                                  description: Use secret discovery service.
                                  properties:
                                    callCredentials:
                                      description: Call credentials.
                                      properties:
                                        fileCredentialSource:
                                          description: Call credentials are coming
                                            from a file,
                                          properties:
                                            header:
                                              description: Header to carry the token.
                                              type: string
                                            tokenFileName:
                                              description: File containing auth token.
                                              type: string
                                          type: object
                                      type: object
                                    certificatesSecretName:
                                      description: The name of the secret containing
                                        the certificate
                                      type: string
                                    clusterName:
                                      description: The name of the sds cluster in
                                        envoy
                                      type: string
                                    targetUri:
                                      description: Target uri for the sds channel.
                                        currently only a unix domain socket is supported.
                                      type: string
                                    validationContextName:
                                      description: The name of secret containing the
                                        validation context (i.e. root ca)
                                      type: string
                                  type: object
                                secretRef:
                                  description: |-
                                    SecretRef contains the secret ref to a gloo tls secret or a kubernetes tls secret.
                                    gloo tls secret can contain a root ca as well if verification is needed.
                                  properties:
                                    name:
                                      description: name of the resource being referenced
                                      type: string
                                    namespace:
                                      description: namespace of the resource being
                                        referenced
                                      type: string
                                  type: object
                                sniDomains:
                                  description: optional. the SNI domains that should
                                    be considered for TLS connections
                                  items:
                                    type: string
                                  type: array
                                sslFiles:
                                  description: SSLFiles reference paths to certificates
                                    which are local to the proxy
                                  properties:
                                    rootCa:
                                      description: for client cert validation. optional
                                      type: string
                                    tlsCert:
                                      type: string
                                    tlsKey:
                                      type: string
                                  type: object
                                verifySubjectAltName:
                                  description: |-
                                    Verify that the Subject Alternative Name in the peer certificate is one of the specified values.
                                    note that a root_ca must be provided if this option is used.
                                  items:
                                    type: string
                                  type: array
                              type: object
                          type: object
                        type: array
                    type: object
                type: object
              type: array
            deployToIngressGateways:
              description: |-
                deploy this VirtualGateway to one or more Ingress Gateway workloads
                {{/* TODO: evaluate supporting multiple ingress gateway deployments per VG */}}
              properties:
                bindAddress:
                  description: |-
                    The bind address the gateway should serve traffic on
                    This maps to the Envoy Listener address.
                    Defaults to "::" or "0.0.0.0".
                  type: string
                bindPort:
                  description: |-
                    The bind port where the gateway workload will listen for connections.
                    This maps to the Envoy Listener port.
                  maximum: 4294967295
                  minimum: 0
                  type: integer
                gatewayWorkloads:
                  description: |-
                    Select which gateway workloads (Envoy pods / Istio ingress-gateways) this config applies to.
                    Ingress pods selected must be in the same Mesh (or Federated VirtualMesh) as the Destination services
                    being routed to.
                  items:
                    properties:
                      kubeWorkloadMatcher:
                        description: Match Kubernetes workloads by their labels, namespaces,
                          and/or clusters.
                        properties:
                          clusters:
                            description: |-
                              If specified, match Kubernetes workloads if they exist in one of the specified clusters.
                                         When used in a networking policy, omission matches any cluster.
                                         When used in a Gloo Mesh Role, a wildcard (`"*"`) must be specified to match any cluster.
                            items:
                              type: string
                            type: array
                          labels:
                            additionalProperties:
                              type: string
                            description: |-
                              If specified, all labels must exist on Kubernetes workload.
                                     When used in a networking policy, omission matches any labels.
                                     When used in a Gloo Mesh Role, a wildcard (`"*"`) must be specified to match any label key and/or value.
                            type: object
                          namespaces:
                            description: |-
                              If specified, match Kubernetes workloads if they exist in one of the specified namespaces.
                                         When used in a networking policy, omission matches any namespace.
                                         When used in a Gloo Mesh Role, a wildcard (`"*"`) must be specified to match any namespace.
                            items:
                              type: string
                            type: array
                        type: object
                    type: object
                  type: array
              type: object
            deployToSidecars:
              description: |-
                deploy this VirtualGateway to one or more workload sidecars
                {{/* NOTE: unimplemented */}}
              items:
                properties:
                  kubeWorkloadMatcher:
                    description: Match Kubernetes workloads by their labels, namespaces,
                      and/or clusters.
                    properties:
                      clusters:
                        description: |-
                          If specified, match Kubernetes workloads if they exist in one of the specified clusters.
                                     When used in a networking policy, omission matches any cluster.
                                     When used in a Gloo Mesh Role, a wildcard (`"*"`) must be specified to match any cluster.
                        items:
                          type: string
                        type: array
                      labels:
                        additionalProperties:
                          type: string
                        description: |-
                          If specified, all labels must exist on Kubernetes workload.
                                 When used in a networking policy, omission matches any labels.
                                 When used in a Gloo Mesh Role, a wildcard (`"*"`) must be specified to match any label key and/or value.
                        type: object
                      namespaces:
                        description: |-
                          If specified, match Kubernetes workloads if they exist in one of the specified namespaces.
                                     When used in a networking policy, omission matches any namespace.
                                     When used in a Gloo Mesh Role, a wildcard (`"*"`) must be specified to match any namespace.
                        items:
                          type: string
                        type: array
                    type: object
                type: object
              type: array
            options:
              description: Options applied to all clients who connect to this gateway
              properties:
                perConnectionBufferLimitBytes:
                  description: |-
                    Soft limit on size of the listener's new connection read and write buffers. If unspecified, defaults to 1MiB
                    For more info, check out the [Envoy docs](https://www.envoyproxy.io/docs/envoy/v1.17.1/api-v3/config/listener/v3/listener.proto)
                  maximum: 4294967295
                  minimum: 0
                  nullable: true
                  type: integer
              type: object
          type: object
        status:
          properties:
            createdIstioGateways:
              additionalProperties:
                properties:
                  refs:
                    items:
                      properties:
                        name:
                          description: name of the resource being referenced
                          type: string
                        namespace:
                          description: namespace of the resource being referenced
                          type: string
                      type: object
                    type: array
                type: object
              description: List of Istio Gateway CRs created by this VirtualGateway
                in each cluster
              type: object
            errors:
              description: Any errors found while processing this generation of the
                resource.
              items:
                type: string
              type: array
            observedGeneration:
              description: |-
                The most recent generation observed in the the VirtualGateway metadata.
                If the `observedGeneration` does not match `metadata.generation`,
                Gloo Mesh has not processed the most recent version of this resource.
              format: int64
              type: integer
            selectedGateways:
              items:
                properties:
                  clusterName:
                    description: the cluster where the gateway workload is running
                    type: string
                  externalUrl:
                    description: the external URL by which the gateway can be accessed
                      on the given workload, if it exists
                    type: string
                  labels:
                    additionalProperties:
                      type: string
                    description: the labels used to identify the gateway workload
                    type: object
                  name:
                    description: the name of the gateway workload
                    type: string
                  namespace:
                    description: the namespace where the gateway workload is running
                    type: string
                type: object
              type: array
            selectedRouteTables:
              description: List of Delegated Route tables that this Route table delegates
                to
              items:
                properties:
                  name:
                    description: name of the resource being referenced
                    type: string
                  namespace:
                    description: namespace of the resource being referenced
                    type: string
                type: object
              type: array
            selectedVirtualHosts:
              items:
                properties:
                  name:
                    description: name of the resource being referenced
                    type: string
                  namespace:
                    description: namespace of the resource being referenced
                    type: string
                type: object
              type: array
            warnings:
              description: Any warnings found while processing this generation of
                the resource.
              items:
                type: string
              type: array
          type: object
      type: object
  versions:
  - name: v1beta1
    served: true
    storage: true

---
apiVersion: apiextensions.k8s.io/v1beta1
kind: CustomResourceDefinition
metadata:
  labels:
    app: gloo-mesh
    app.kubernetes.io/name: gloo-mesh
  name: virtualhosts.networking.enterprise.mesh.gloo.solo.io
spec:
  group: networking.enterprise.mesh.gloo.solo.io
  names:
    kind: VirtualHost
    listKind: VirtualHostList
    plural: virtualhosts
    singular: virtualhost
  preserveUnknownFields: false
  scope: Namespaced
  subresources:
    status: {}
  validation:
    openAPIV3Schema:
      properties:
        spec:
          description: |-
            A `VirtualHost` is used to configure routes. It is selected by a `VirtualGateway`, and may be attached
               to more than one gateway. The `VirtualHost` contains the top-level configuration and route options, such
               as domains to match against, and any options to be shared by its routes. Routes can send traffic directly
               to a service, or can delegate to a `RouteTable` to perform further routing decisions.
          properties:
            domains:
              description: |-
                The list of domains (i.e.: matching the `Host` header of a request) that belong to this virtual host.
                Note that the wildcard will not match the empty string. e.g. “*-bar.foo.com” will match “baz-bar.foo.com”
                but not “-bar.foo.com”. Additionally, a special entry “*” is allowed which will match any host/authority header.
                Only a single virtual host on a gateway can match on “*”. A domain must be unique across all
                virtual hosts on a gateway or the config will be invalidated by Gloo
                Domains on virtual hosts obey the same rules as [Envoy Virtual Hosts](https://github.com/envoyproxy/envoy/blob/master/api/envoy/api/v2/route/route.proto)
              items:
                type: string
              type: array
            options:
              description: |-
                Route table options contain additional configuration to be applied to all traffic served by the route table.
                Some configuration here can be overridden by Route Options.
                OutlierDetection and TrafficShift isn't supported on the route level.
              properties:
                trafficPolicy:
                  properties:
                    corsPolicy:
                      description: |-
                        Set a Cross-Origin Resource Sharing policy (CORS) for requests. Refer to [this link](https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS)
                        for further details about cross origin resource sharing.
                      properties:
                        allowCredentials:
                          description: |-
                            Indicates whether the caller is allowed to send the actual request
                            (not the preflight) using credentials. Translates to the
                            `Access-Control-Allow-Credentials` header.
                          nullable: true
                          type: boolean
                        allowHeaders:
                          description: |-
                            List of HTTP headers that can be used when requesting the
                            resource. Serialized to the `Access-Control-Allow-Headers` header.
                          items:
                            type: string
                          type: array
                        allowMethods:
                          description: |-
                            List of HTTP methods allowed to access the resource. The content will
                            be serialized to the `Access-Control-Allow-Methods` header.
                          items:
                            type: string
                          type: array
                        allowOrigins:
                          description: String patterns that match allowed origins.
                            An origin is allowed if any of the string matchers match.
                          items:
                            oneOf:
                            - not:
                                anyOf:
                                - required:
                                  - exact
                                - required:
                                  - prefix
                                - required:
                                  - regex
                                - required:
                                  - suffix
                            - required:
                              - exact
                            - required:
                              - prefix
                            - required:
                              - regex
                            - required:
                              - suffix
                            properties:
                              exact:
                                description: Exact string match.
                                type: string
                              ignoreCase:
                                description: If true, indicates the exact/prefix/suffix
                                  matching should be case insensitive. This has no
                                  effect for the regex match.
                                type: boolean
                              prefix:
                                description: Prefix-based match.
                                type: string
                              regex:
                                description: ECMAscript style regex-based match.
                                type: string
                              suffix:
                                description: Suffix-based match.
                                type: string
                            type: object
                          type: array
                        exposeHeaders:
                          description: |-
                            A list of HTTP headers that browsers are allowed to
                            access. Serialized to the `Access-Control-Expose-Headers` header.
                          items:
                            type: string
                          type: array
                        maxAge:
                          description: |-
                            Specify how long the results of a preflight request can be
                            cached. Serialized to the `Access-Control-Max-Age` header.
                          type: string
                      type: object
                    csrf:
                      description: Configure the Envoy based CSRF filter
                      properties:
                        additionalOrigins:
                          description: |-
                            Specifies additional source origins that will be allowed in addition to
                            the destination origin.
                          items:
                            oneOf:
                            - not:
                                anyOf:
                                - required:
                                  - exact
                                - required:
                                  - prefix
                                - required:
                                  - regex
                                - required:
                                  - suffix
                            - required:
                              - exact
                            - required:
                              - prefix
                            - required:
                              - regex
                            - required:
                              - suffix
                            properties:
                              exact:
                                description: Exact string match.
                                type: string
                              ignoreCase:
                                description: If true, indicates the exact/prefix/suffix
                                  matching should be case insensitive. This has no
                                  effect for the regex match.
                                type: boolean
                              prefix:
                                description: Prefix-based match.
                                type: string
                              regex:
                                description: ECMAscript style regex-based match.
                                type: string
                              suffix:
                                description: Suffix-based match.
                                type: string
                            type: object
                          type: array
                        filterEnabled:
                          description: Specifies that CSRF policies will be evaluated,
                            tracked and enforced.
                          type: boolean
                        percentage:
                          description: |-
                            Specifies the % of requests for which the CSRF filter is enabled or when shadow mode is enabled the % of requests
                            evaluated and tracked, but not enforced.

                            If filter_enabled or shadow_enabled is true.
                            Envoy will lookup the runtime key to get the percentage of requests to filter.

                            .. note:: This field defaults to 100
                          format: double
                          type: number
                        shadowEnabled:
                          description: |-
                            Specifies that CSRF policies will be evaluated and tracked, but not enforced.

                            This is intended to be used when ``filter_enabled`` is false and will be ignored otherwise.
                          type: boolean
                      type: object
                    faultInjection:
                      description: Inject faulty responses.
                      oneOf:
                      - not:
                          anyOf:
                          - required:
                            - fixedDelay
                          - required:
                            - abort
                      - required:
                        - fixedDelay
                      - required:
                        - abort
                      properties:
                        abort:
                          description: Abort the request and return the specified
                            error code back to traffic source.
                          properties:
                            httpStatus:
                              description: Required. HTTP status code to use to abort
                                the request.
                              format: int32
                              type: integer
                          type: object
                        fixedDelay:
                          description: 'Add a delay of a fixed duration before sending
                            the request. Format: `1h`/`1m`/`1s`/`1ms`. MUST be >=1ms.'
                          type: string
                        percentage:
                          description: Percentage of requests to be faulted. Values
                            range between 0 and 100. If omitted all requests will
                            be faulted.
                          format: double
                          type: number
                      type: object
                    headerManipulation:
                      description: Manipulate request and response headers.
                      properties:
                        appendRequestHeaders:
                          additionalProperties:
                            type: string
                          description: Additional HTTP headers to add before forwarding
                            a request to the destination service.
                          type: object
                        appendResponseHeaders:
                          additionalProperties:
                            type: string
                          description: Additional HTTP headers to add before returning
                            a response to the caller.
                          type: object
                        removeRequestHeaders:
                          description: HTTP headers to remove before forwarding a
                            request to the destination service.
                          items:
                            type: string
                          type: array
                        removeResponseHeaders:
                          description: HTTP headers to remove before returning a response
                            to the caller.
                          items:
                            type: string
                          type: array
                      type: object
                    mirror:
                      description: Mirror traffic to a another destination (traffic
                        will be sent to its original destination in addition to the
                        mirrored destinations).
                      oneOf:
                      - not:
                          anyOf:
                          - required:
                            - kubeService
                      - required:
                        - kubeService
                      properties:
                        kubeService:
                          description: Reference (name, namespace, Gloo Mesh cluster)
                            to a Kubernetes service.
                          properties:
                            clusterName:
                              description: name of the cluster in which the resource
                                exists
                              type: string
                            name:
                              description: name of the resource being referenced
                              type: string
                            namespace:
                              description: namespace of the resource being referenced
                              type: string
                          type: object
                        percentage:
                          description: Percentage of traffic to mirror. If omitted
                            all traffic will be mirrored. Values must be between 0
                            and 100.
                          format: double
                          type: number
                        port:
                          description: Port on the destination to receive traffic.
                            Required if the destination exposes multiple ports.
                          maximum: 4294967295
                          minimum: 0
                          type: integer
                      type: object
                    mtls:
                      description: Configure mTLS settings. If specified will override
                        global default defined in Settings.
                      properties:
                        istio:
                          description: Istio TLS settings.
                          properties:
                            tlsMode:
                              description: TLS connection mode
                              enum:
                              - DISABLE
                              - SIMPLE
                              - ISTIO_MUTUAL
                              type: string
                          type: object
                      type: object
                    outlierDetection:
                      description: |-
                        Configure [outlier detection](https://www.envoyproxy.io/docs/envoy/latest/intro/arch_overview/upstream/outlier) on the selected destinations.
                        Specifying this field requires an empty `source_selector` because it must apply to all traffic.
                      properties:
                        baseEjectionTime:
                          description: 'The minimum ejection duration. Format: `1h`/`1m`/`1s`/`1ms`.
                            Must be >= `1ms`. A default will be used if not set.'
                          type: string
                        consecutiveErrors:
                          description: The number of errors before a host is ejected
                            from the connection pool. A default will be used if not
                            set.
                          maximum: 4294967295
                          minimum: 0
                          type: integer
                        interval:
                          description: 'The time interval between ejection sweep analysis.
                            Format: `1h`/`1m`/`1s`/`1ms`. Must be >= `1ms`. A default
                            will be used if not set.'
                          type: string
                        maxEjectionPercent:
                          description: |-
                            The maximum percentage of hosts that can be ejected from the load balancing pool.
                            At least one host will be ejected regardless of the value. Must be between 0 and 100. A default will be used if not set.
                          maximum: 4294967295
                          minimum: 0
                          type: integer
                      type: object
                    rateLimit:
                      description: Config the Envoy based Ratelimit filter
                      oneOf:
                      - not:
                          anyOf:
                          - required:
                            - basic
                          - required:
                            - advanced
                          - required:
                            - configRefs
                      - required:
                        - basic
                      - required:
                        - advanced
                      - required:
                        - configRefs
                      properties:
                        advanced:
                          description: |-
                            Partial config for GlooE rate-limiting based on Envoy's rate-limit service;
                            supports Envoy's rate-limit service API. (reference here: https://github.com/lyft/ratelimit#configuration)
                            Configure rate-limit *actions* here, which define how request characteristics get translated into
                            descriptors used by the rate-limit service for rate-limiting. Configure rate-limit *descriptors* and
                            their associated limits on the Gloo settings.
                            Only one of `ratelimit` or `rate_limit_configs` can be set.
                          properties:
                            actions:
                              description: |-
                                Define individual rate limits here. Each rate limit will be evaluated, if any rate limit
                                would be throttled, the entire request returns a 429 (gets throttled)
                              items:
                                properties:
                                  actions:
                                    description: 'TODO: come up with descriptive names
                                      and comments for these fields'
                                    items:
                                      oneOf:
                                      - not:
                                          anyOf:
                                          - required:
                                            - sourceCluster
                                          - required:
                                            - destinationCluster
                                          - required:
                                            - requestHeaders
                                          - required:
                                            - remoteAddress
                                          - required:
                                            - genericKey
                                          - required:
                                            - headerValueMatch
                                      - required:
                                        - sourceCluster
                                      - required:
                                        - destinationCluster
                                      - required:
                                        - requestHeaders
                                      - required:
                                        - remoteAddress
                                      - required:
                                        - genericKey
                                      - required:
                                        - headerValueMatch
                                      properties:
                                        destinationCluster:
                                          description: Rate limit on destination cluster.
                                          type: object
                                        genericKey:
                                          description: Rate limit on a generic key.
                                          properties:
                                            descriptorValue:
                                              description: The value to use in the
                                                descriptor entry.
                                              type: string
                                          type: object
                                        headerValueMatch:
                                          description: Rate limit on the existence
                                            of request headers.
                                          properties:
                                            descriptorValue:
                                              description: The value to use in the
                                                descriptor entry.
                                              type: string
                                            expectMatch:
                                              description: |-
                                                If set to true, the action will append a descriptor entry when the
                                                request matches the headers. If set to false, the action will append a
                                                descriptor entry when the request does not match the headers. The
                                                default value is true.
                                              nullable: true
                                              type: boolean
                                            headers:
                                              description: |-
                                                Specifies a set of headers that the rate limit action should match
                                                on. The action will check the request’s headers against all the
                                                specified headers in the config. A match will happen if all the
                                                headers in the config are present in the request with the same values
                                                (or based on presence if the value field is not in the config).
                                              items:
                                                oneOf:
                                                - not:
                                                    anyOf:
                                                    - required:
                                                      - exactMatch
                                                    - required:
                                                      - regexMatch
                                                    - required:
                                                      - rangeMatch
                                                    - required:
                                                      - presentMatch
                                                    - required:
                                                      - prefixMatch
                                                    - required:
                                                      - suffixMatch
                                                - required:
                                                  - exactMatch
                                                - required:
                                                  - regexMatch
                                                - required:
                                                  - rangeMatch
                                                - required:
                                                  - presentMatch
                                                - required:
                                                  - prefixMatch
                                                - required:
                                                  - suffixMatch
                                                properties:
                                                  exactMatch:
                                                    description: If specified, header
                                                      match will be performed based
                                                      on the value of the header.
                                                    type: string
                                                  invertMatch:
                                                    description: |-
                                                      If specified, the match result will be inverted before checking. Defaults to false.

                                                      Examples:

                                                      * The regex *\d{3}* does not match the value *1234*, so it will match when inverted.
                                                      * The range [-10,0) will match the value -1, so it will not match when inverted.
                                                    type: boolean
                                                  name:
                                                    description: Specifies the name
                                                      of the header in the request.
                                                    type: string
                                                  prefixMatch:
                                                    description: |-
                                                      If specified, header match will be performed based on the prefix of the header value.
                                                      Note: empty prefix is not allowed, please use present_match instead.

                                                      Examples:

                                                      * The prefix *abcd* matches the value *abcdxyz*, but not for *abcxyz*.
                                                    type: string
                                                  presentMatch:
                                                    description: |-
                                                      If specified, header match will be performed based on whether the header is in the
                                                      request.
                                                    type: boolean
                                                  rangeMatch:
                                                    description: |-
                                                      If specified, header match will be performed based on range.
                                                      The rule will match if the request header value is within this range.
                                                      The entire request header value must represent an integer in base 10 notation: consisting of
                                                      an optional plus or minus sign followed by a sequence of digits. The rule will not match if
                                                      the header value does not represent an integer. Match will fail for empty values, floating
                                                      point numbers or if only a subsequence of the header value is an integer.

                                                      Examples:

                                                      * For range [-10,0), route will match for header value -1, but not for 0, "somestring", 10.9,
                                                        "-1somestring"
                                                    properties:
                                                      end:
                                                        description: end of the range
                                                          (exclusive)
                                                        format: int64
                                                        type: integer
                                                      start:
                                                        description: start of the
                                                          range (inclusive)
                                                        format: int64
                                                        type: integer
                                                    type: object
                                                  regexMatch:
                                                    description: |-
                                                      If specified, this regex string is a regular expression rule which implies the entire request
                                                      header value must match the regex. The rule will not match if only a subsequence of the
                                                      request header value matches the regex. The regex grammar used in the value field is defined
                                                      `(here)[https://en.cppreference.com/w/cpp/regex/ecmascript]`.

                                                      Examples:

                                                      * The regex *\d{3}* matches the value *123*
                                                      * The regex *\d{3}* does not match the value *1234*
                                                      * The regex *\d{3}* does not match the value *123.456*
                                                    type: string
                                                  suffixMatch:
                                                    description: |-
                                                      If specified, header match will be performed based on the suffix of the header value.
                                                      Note: empty suffix is not allowed, please use present_match instead.

                                                      Examples:

                                                      * The suffix *abcd* matches the value *xyzabcd*, but not for *xyzbcd*.
                                                    type: string
                                                type: object
                                              type: array
                                          type: object
                                        remoteAddress:
                                          description: Rate limit on remote address.
                                          type: object
                                        requestHeaders:
                                          description: Rate limit on request headers.
                                          properties:
                                            descriptorKey:
                                              description: The key to use in the descriptor
                                                entry.
                                              type: string
                                            headerName:
                                              description: |-
                                                The header name to be queried from the request headers. The header’s
                                                value is used to populate the value of the descriptor entry for the
                                                descriptor_key.
                                              type: string
                                          type: object
                                        sourceCluster:
                                          description: Rate limit on source cluster.
                                          type: object
                                      type: object
                                    type: array
                                  setActions:
                                    items:
                                      oneOf:
                                      - not:
                                          anyOf:
                                          - required:
                                            - sourceCluster
                                          - required:
                                            - destinationCluster
                                          - required:
                                            - requestHeaders
                                          - required:
                                            - remoteAddress
                                          - required:
                                            - genericKey
                                          - required:
                                            - headerValueMatch
                                      - required:
                                        - sourceCluster
                                      - required:
                                        - destinationCluster
                                      - required:
                                        - requestHeaders
                                      - required:
                                        - remoteAddress
                                      - required:
                                        - genericKey
                                      - required:
                                        - headerValueMatch
                                      properties:
                                        destinationCluster:
                                          description: Rate limit on destination cluster.
                                          type: object
                                        genericKey:
                                          description: Rate limit on a generic key.
                                          properties:
                                            descriptorValue:
                                              description: The value to use in the
                                                descriptor entry.
                                              type: string
                                          type: object
                                        headerValueMatch:
                                          description: Rate limit on the existence
                                            of request headers.
                                          properties:
                                            descriptorValue:
                                              description: The value to use in the
                                                descriptor entry.
                                              type: string
                                            expectMatch:
                                              description: |-
                                                If set to true, the action will append a descriptor entry when the
                                                request matches the headers. If set to false, the action will append a
                                                descriptor entry when the request does not match the headers. The
                                                default value is true.
                                              nullable: true
                                              type: boolean
                                            headers:
                                              description: |-
                                                Specifies a set of headers that the rate limit action should match
                                                on. The action will check the request’s headers against all the
                                                specified headers in the config. A match will happen if all the
                                                headers in the config are present in the request with the same values
                                                (or based on presence if the value field is not in the config).
                                              items:
                                                oneOf:
                                                - not:
                                                    anyOf:
                                                    - required:
                                                      - exactMatch
                                                    - required:
                                                      - regexMatch
                                                    - required:
                                                      - rangeMatch
                                                    - required:
                                                      - presentMatch
                                                    - required:
                                                      - prefixMatch
                                                    - required:
                                                      - suffixMatch
                                                - required:
                                                  - exactMatch
                                                - required:
                                                  - regexMatch
                                                - required:
                                                  - rangeMatch
                                                - required:
                                                  - presentMatch
                                                - required:
                                                  - prefixMatch
                                                - required:
                                                  - suffixMatch
                                                properties:
                                                  exactMatch:
                                                    description: If specified, header
                                                      match will be performed based
                                                      on the value of the header.
                                                    type: string
                                                  invertMatch:
                                                    description: |-
                                                      If specified, the match result will be inverted before checking. Defaults to false.

                                                      Examples:

                                                      * The regex *\d{3}* does not match the value *1234*, so it will match when inverted.
                                                      * The range [-10,0) will match the value -1, so it will not match when inverted.
                                                    type: boolean
                                                  name:
                                                    description: Specifies the name
                                                      of the header in the request.
                                                    type: string
                                                  prefixMatch:
                                                    description: |-
                                                      If specified, header match will be performed based on the prefix of the header value.
                                                      Note: empty prefix is not allowed, please use present_match instead.

                                                      Examples:

                                                      * The prefix *abcd* matches the value *abcdxyz*, but not for *abcxyz*.
                                                    type: string
                                                  presentMatch:
                                                    description: |-
                                                      If specified, header match will be performed based on whether the header is in the
                                                      request.
                                                    type: boolean
                                                  rangeMatch:
                                                    description: |-
                                                      If specified, header match will be performed based on range.
                                                      The rule will match if the request header value is within this range.
                                                      The entire request header value must represent an integer in base 10 notation: consisting of
                                                      an optional plus or minus sign followed by a sequence of digits. The rule will not match if
                                                      the header value does not represent an integer. Match will fail for empty values, floating
                                                      point numbers or if only a subsequence of the header value is an integer.

                                                      Examples:

                                                      * For range [-10,0), route will match for header value -1, but not for 0, "somestring", 10.9,
                                                        "-1somestring"
                                                    properties:
                                                      end:
                                                        description: end of the range
                                                          (exclusive)
                                                        format: int64
                                                        type: integer
                                                      start:
                                                        description: start of the
                                                          range (inclusive)
                                                        format: int64
                                                        type: integer
                                                    type: object
                                                  regexMatch:
                                                    description: |-
                                                      If specified, this regex string is a regular expression rule which implies the entire request
                                                      header value must match the regex. The rule will not match if only a subsequence of the
                                                      request header value matches the regex. The regex grammar used in the value field is defined
                                                      `(here)[https://en.cppreference.com/w/cpp/regex/ecmascript]`.

                                                      Examples:

                                                      * The regex *\d{3}* matches the value *123*
                                                      * The regex *\d{3}* does not match the value *1234*
                                                      * The regex *\d{3}* does not match the value *123.456*
                                                    type: string
                                                  suffixMatch:
                                                    description: |-
                                                      If specified, header match will be performed based on the suffix of the header value.
                                                      Note: empty suffix is not allowed, please use present_match instead.

                                                      Examples:

                                                      * The suffix *abcd* matches the value *xyzabcd*, but not for *xyzbcd*.
                                                    type: string
                                                type: object
                                              type: array
                                          type: object
                                        remoteAddress:
                                          description: Rate limit on remote address.
                                          type: object
                                        requestHeaders:
                                          description: Rate limit on request headers.
                                          properties:
                                            descriptorKey:
                                              description: The key to use in the descriptor
                                                entry.
                                              type: string
                                            headerName:
                                              description: |-
                                                The header name to be queried from the request headers. The header’s
                                                value is used to populate the value of the descriptor entry for the
                                                descriptor_key.
                                              type: string
                                          type: object
                                        sourceCluster:
                                          description: Rate limit on source cluster.
                                          type: object
                                      type: object
                                    type: array
                                type: object
                              type: array
                          type: object
                        basic:
                          description: Config for rate-limiting using simplified (gloo-specific)
                            API
                          properties:
                            anonymousLimits:
                              description: limits for unauthorized users
                              properties:
                                requestsPerUnit:
                                  maximum: 4294967295
                                  minimum: 0
                                  type: integer
                                unit:
                                  enum:
                                  - UNKNOWN
                                  - SECOND
                                  - MINUTE
                                  - HOUR
                                  - DAY
                                  type: string
                              type: object
                            authorizedLimits:
                              description: limits for authorized users
                              properties:
                                requestsPerUnit:
                                  maximum: 4294967295
                                  minimum: 0
                                  type: integer
                                unit:
                                  enum:
                                  - UNKNOWN
                                  - SECOND
                                  - MINUTE
                                  - HOUR
                                  - DAY
                                  type: string
                              type: object
                          type: object
                        configRefs:
                          description: |-
                            References to RateLimitConfig resources. This is used to configure the GlooE rate limit server.
                            Only one of `ratelimit` or `rate_limit_configs` can be set.
                          properties:
                            refs:
                              items:
                                properties:
                                  name:
                                    description: name of the resource being referenced
                                    type: string
                                  namespace:
                                    description: namespace of the resource being referenced
                                    type: string
                                type: object
                              type: array
                          type: object
                      type: object
                    requestTimeout:
                      description: Set a timeout on requests.
                      type: string
                    retries:
                      description: Set a retry policy on requests.
                      properties:
                        attempts:
                          description: Number of retries for a given request
                          format: int32
                          type: integer
                        perTryTimeout:
                          description: 'Timeout per retry attempt for a given request.
                            Format: `1h`/`1m`/`1s`/`1ms`. *Must be >= 1ms*.'
                          type: string
                      type: object
                    trafficShift:
                      description: Shift traffic to a different destination.
                      properties:
                        destinations:
                          description: Specify weighted traffic shift destinations.
                          items:
                            oneOf:
                            - not:
                                anyOf:
                                - required:
                                  - kubeService
                                - required:
                                  - virtualDestination
                                - required:
                                  - staticDestination
                                - required:
                                  - clusterHeader
                            - required:
                              - kubeService
                            - required:
                              - virtualDestination
                            - required:
                              - staticDestination
                            - required:
                              - clusterHeader
                            properties:
                              clusterHeader:
                                description: |-
                                  Envoy will determine the cluster to route to by reading the value of the HTTP header named by cluster_header from the request headers.
                                  If the header is not found or the referenced cluster does not exist, Envoy will return a 404 response.
                                  Avoid using this whenever possible, it does not allow for custom filter configuration based on Virtual Host.
                                  {{/* NOTE: unimplemented */}}
                                type: string
                              kubeService:
                                description: Specify a Kubernetes Service.
                                properties:
                                  clusterName:
                                    description: The Gloo Mesh cluster name (registration
                                      name) of the service.
                                    type: string
                                  name:
                                    description: The name of the service.
                                    type: string
                                  namespace:
                                    description: The namespace of the service.
                                    type: string
                                  port:
                                    description: Port on the service to receive traffic.
                                      Required if the service exposes more than one
                                      port.
                                    maximum: 4294967295
                                    minimum: 0
                                    type: integer
                                  subset:
                                    additionalProperties:
                                      type: string
                                    description: Specify, by labels, a subset of service
                                      instances to route to.
                                    type: object
                                type: object
                              options:
                                description: |-
                                  additional options / config for a route which will be applied
                                  when this destination is selected.
                                properties:
                                  headerManipulation:
                                    description: manipualte headers on traffic sent
                                      to this destination
                                    properties:
                                      appendRequestHeaders:
                                        additionalProperties:
                                          type: string
                                        description: Additional HTTP headers to add
                                          before forwarding a request to the destination
                                          service.
                                        type: object
                                      appendResponseHeaders:
                                        additionalProperties:
                                          type: string
                                        description: Additional HTTP headers to add
                                          before returning a response to the caller.
                                        type: object
                                      removeRequestHeaders:
                                        description: HTTP headers to remove before
                                          forwarding a request to the destination
                                          service.
                                        items:
                                          type: string
                                        type: array
                                      removeResponseHeaders:
                                        description: HTTP headers to remove before
                                          returning a response to the caller.
                                        items:
                                          type: string
                                        type: array
                                    type: object
                                type: object
                              staticDestination:
                                description: Reference to a gloo mesh Static Destination
                                properties:
                                  name:
                                    description: name of the resource being referenced
                                    type: string
                                  namespace:
                                    description: namespace of the resource being referenced
                                    type: string
                                type: object
                              virtualDestination:
                                description: Specify a VirtualDestination.
                                properties:
                                  name:
                                    description: The name of the VirtualDestination
                                      object.
                                    type: string
                                  namespace:
                                    description: The namespace of the VirtualDestination
                                      object.
                                    type: string
                                  subset:
                                    additionalProperties:
                                      type: string
                                    description: Specify, by labels, a subset of service
                                      instances backing the VirtualDestination to
                                      route to.
                                    type: object
                                type: object
                              weight:
                                description: |-
                                  Specify the proportion of traffic to be forwarded to this destination.
                                  Weights across all of the `destinations` must sum to 100.
                                maximum: 4294967295
                                minimum: 0
                                type: integer
                            type: object
                          type: array
                      type: object
                  type: object
              type: object
            routes:
              description: |-
                The list of HTTP routes define routing actions to be taken for incoming HTTP requests whose host header matches
                this virtual host. If the request matches more than one route in the list, the first route matched will be selected.
                If the list of routes is empty, the virtual host will be ignored by Gloo.
              items:
                oneOf:
                - not:
                    anyOf:
                    - required:
                      - routeAction
                    - properties:
                        redirectAction:
                          oneOf:
                          - not:
                              anyOf:
                              - required:
                                - pathRedirect
                              - required:
                                - prefixRewrite
                          - required:
                            - pathRedirect
                          - required:
                            - prefixRewrite
                      required:
                      - redirectAction
                    - required:
                      - directResponseAction
                    - required:
                      - delegateAction
                - required:
                  - routeAction
                - properties:
                    redirectAction:
                      oneOf:
                      - not:
                          anyOf:
                          - required:
                            - pathRedirect
                          - required:
                            - prefixRewrite
                      - required:
                        - pathRedirect
                      - required:
                        - prefixRewrite
                  required:
                  - redirectAction
                - required:
                  - directResponseAction
                - required:
                  - delegateAction
                properties:
                  delegateAction:
                    description: Delegate routing actions for the given matcher to
                      one or more RouteTables.
                    properties:
                      refs:
                        description: Delegate to the RouteTable resources with matching
                          `name` and `namespace`.
                        items:
                          properties:
                            name:
                              description: name of the resource being referenced
                              type: string
                            namespace:
                              description: namespace of the resource being referenced
                              type: string
                          type: object
                        type: array
                      selector:
                        description: Delegate to the RouteTables that match the given
                          selector.
                        properties:
                          expressions:
                            description: |-
                              Expressions allow for more flexible object label matching, such as equality-based requirements, set-based requirements, or a combination of both.
                              https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/#equality-based-requirement
                            items:
                              properties:
                                key:
                                  description: |-
                                    Kubernetes label key, must conform to Kubernetes syntax requirements
                                    https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/#syntax-and-character-set
                                  type: string
                                operator:
                                  description: The operator can only be in, notin,
                                    =, ==, !=, exists, ! (DoesNotExist), gt (GreaterThan),
                                    lt (LessThan).
                                  enum:
                                  - Equals
                                  - DoubleEquals
                                  - NotEquals
                                  - In
                                  - NotIn
                                  - Exists
                                  - DoesNotExist
                                  - GreaterThan
                                  - LessThan
                                  type: string
                                values:
                                  items:
                                    type: string
                                  type: array
                              type: object
                            type: array
                          labels:
                            additionalProperties:
                              type: string
                            description: Select objects whose labels match the ones
                              specified here.
                            type: object
                          namespaces:
                            description: |-
                              Select Objects in these namespaces. If omitted, Gloo Mesh will only select Objects in the same namespace
                              as the parent resource (e.g. VirtualGateway) that owns this selector.
                              The reserved value "*" can be used to select objects in all namespaces watched by Gloo Mesh.
                            items:
                              type: string
                            type: array
                        type: object
                    type: object
                  directResponseAction:
                    description: Return an arbitrary HTTP response directly, without
                      proxying.
                    properties:
                      body:
                        description: |-
                          Specifies the content of the response body. If this setting is omitted,
                          no body is included in the generated response.

                          Note: Headers can be specified using the Header Modification feature in the enclosing
                          Route, ConnectionHandler, or Gateway options.
                        type: string
                      status:
                        description: Specifies the HTTP response status to be returned.
                        maximum: 4294967295
                        minimum: 0
                        type: integer
                    type: object
                  matchers:
                    description: |-
                      Matchers contain parameters for matching requests (i.e., based on HTTP path, headers, etc.).
                      If empty, the route will match all requests (i.e, a single "/" path prefix matcher).
                      For delegated routes, any parent matcher must have a `prefix` path matcher.
                    items:
                      properties:
                        headers:
                          description: Specify a set of headers which requests must
                            match in entirety (all headers must match).
                          items:
                            properties:
                              invertMatch:
                                description: |-
                                  If set to true, the result of the match will be inverted. Defaults to false.

                                     Examples:

                                         - name=foo, invert_match=true: matches if no header named `foo` is present
                                         - name=foo, value=bar, invert_match=true: matches if no header named `foo` with value `bar` is present
                                         - name=foo, value=``\d{3}``, regex=true, invert_match=true: matches if no header named `foo` with a value consisting of three integers is present.
                                type: boolean
                              name:
                                description: Specify the name of the header in the
                                  request.
                                type: string
                              regex:
                                description: Specify whether the header value should
                                  be treated as regex.
                                type: boolean
                              value:
                                description: |-
                                  Specify the value of the header. If the value is absent a request that
                                  has the name header will match, regardless of the header’s value.
                                type: string
                            type: object
                          type: array
                        method:
                          description: Specify an HTTP method to match against.
                          type: string
                        name:
                          description: |-
                            The name assigned to a match. The match's name will be
                            concatenated with the parent route's name and will be logged in
                            the access logs for requests matching this route.
                          type: string
                        queryParameters:
                          description: Specify a set of URL query parameters which
                            requests must match in entirety (all query params must
                            match).
                          items:
                            properties:
                              name:
                                description: Specify the name of a key that must be
                                  present in the requested path's query string.
                                type: string
                              regex:
                                description: If true, treat `value` as a regular expression.
                                type: boolean
                              value:
                                description: Specify the value of the query parameter
                                  keyed on `name`.
                                type: string
                            type: object
                          type: array
                        uri:
                          description: Specify match criteria against the targeted
                            path.
                          oneOf:
                          - not:
                              anyOf:
                              - required:
                                - exact
                              - required:
                                - prefix
                              - required:
                                - regex
                              - required:
                                - suffix
                          - required:
                            - exact
                          - required:
                            - prefix
                          - required:
                            - regex
                          - required:
                            - suffix
                          properties:
                            exact:
                              description: Exact string match.
                              type: string
                            ignoreCase:
                              description: If true, indicates the exact/prefix/suffix
                                matching should be case insensitive. This has no effect
                                for the regex match.
                              type: boolean
                            prefix:
                              description: Prefix-based match.
                              type: string
                            regex:
                              description: ECMAscript style regex-based match.
                              type: string
                            suffix:
                              description: Suffix-based match.
                              type: string
                          type: object
                      type: object
                    type: array
                  name:
                    description: |-
                      The name provides a convenience for users to be able to refer to a route by name.
                      It includes names of VS, Route, and RouteTable ancestors of the Route.
                    type: string
                  options:
                    description: |-
                      Route Options extend the behavior of routes.
                      Route options include configuration such as retries, rate limiting, and request/response transformation.
                      RouteOption behavior will be inherited by delegated routes which do not specify their own `options`
                    properties:
                      corsPolicy:
                        description: |-
                          Set a Cross-Origin Resource Sharing policy (CORS) for requests. Refer to [this link](https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS)
                          for further details about cross origin resource sharing.
                        properties:
                          allowCredentials:
                            description: |-
                              Indicates whether the caller is allowed to send the actual request
                              (not the preflight) using credentials. Translates to the
                              `Access-Control-Allow-Credentials` header.
                            nullable: true
                            type: boolean
                          allowHeaders:
                            description: |-
                              List of HTTP headers that can be used when requesting the
                              resource. Serialized to the `Access-Control-Allow-Headers` header.
                            items:
                              type: string
                            type: array
                          allowMethods:
                            description: |-
                              List of HTTP methods allowed to access the resource. The content will
                              be serialized to the `Access-Control-Allow-Methods` header.
                            items:
                              type: string
                            type: array
                          allowOrigins:
                            description: String patterns that match allowed origins.
                              An origin is allowed if any of the string matchers match.
                            items:
                              oneOf:
                              - not:
                                  anyOf:
                                  - required:
                                    - exact
                                  - required:
                                    - prefix
                                  - required:
                                    - regex
                                  - required:
                                    - suffix
                              - required:
                                - exact
                              - required:
                                - prefix
                              - required:
                                - regex
                              - required:
                                - suffix
                              properties:
                                exact:
                                  description: Exact string match.
                                  type: string
                                ignoreCase:
                                  description: If true, indicates the exact/prefix/suffix
                                    matching should be case insensitive. This has
                                    no effect for the regex match.
                                  type: boolean
                                prefix:
                                  description: Prefix-based match.
                                  type: string
                                regex:
                                  description: ECMAscript style regex-based match.
                                  type: string
                                suffix:
                                  description: Suffix-based match.
                                  type: string
                              type: object
                            type: array
                          exposeHeaders:
                            description: |-
                              A list of HTTP headers that browsers are allowed to
                              access. Serialized to the `Access-Control-Expose-Headers` header.
                            items:
                              type: string
                            type: array
                          maxAge:
                            description: |-
                              Specify how long the results of a preflight request can be
                              cached. Serialized to the `Access-Control-Max-Age` header.
                            type: string
                        type: object
                      csrf:
                        description: Configure the Envoy based CSRF filter
                        properties:
                          additionalOrigins:
                            description: |-
                              Specifies additional source origins that will be allowed in addition to
                              the destination origin.
                            items:
                              oneOf:
                              - not:
                                  anyOf:
                                  - required:
                                    - exact
                                  - required:
                                    - prefix
                                  - required:
                                    - regex
                                  - required:
                                    - suffix
                              - required:
                                - exact
                              - required:
                                - prefix
                              - required:
                                - regex
                              - required:
                                - suffix
                              properties:
                                exact:
                                  description: Exact string match.
                                  type: string
                                ignoreCase:
                                  description: If true, indicates the exact/prefix/suffix
                                    matching should be case insensitive. This has
                                    no effect for the regex match.
                                  type: boolean
                                prefix:
                                  description: Prefix-based match.
                                  type: string
                                regex:
                                  description: ECMAscript style regex-based match.
                                  type: string
                                suffix:
                                  description: Suffix-based match.
                                  type: string
                              type: object
                            type: array
                          filterEnabled:
                            description: Specifies that CSRF policies will be evaluated,
                              tracked and enforced.
                            type: boolean
                          percentage:
                            description: |-
                              Specifies the % of requests for which the CSRF filter is enabled or when shadow mode is enabled the % of requests
                              evaluated and tracked, but not enforced.

                              If filter_enabled or shadow_enabled is true.
                              Envoy will lookup the runtime key to get the percentage of requests to filter.

                              .. note:: This field defaults to 100
                            format: double
                            type: number
                          shadowEnabled:
                            description: |-
                              Specifies that CSRF policies will be evaluated and tracked, but not enforced.

                              This is intended to be used when ``filter_enabled`` is false and will be ignored otherwise.
                            type: boolean
                        type: object
                      faultInjection:
                        description: Inject faulty responses.
                        oneOf:
                        - not:
                            anyOf:
                            - required:
                              - fixedDelay
                            - required:
                              - abort
                        - required:
                          - fixedDelay
                        - required:
                          - abort
                        properties:
                          abort:
                            description: Abort the request and return the specified
                              error code back to traffic source.
                            properties:
                              httpStatus:
                                description: Required. HTTP status code to use to
                                  abort the request.
                                format: int32
                                type: integer
                            type: object
                          fixedDelay:
                            description: 'Add a delay of a fixed duration before sending
                              the request. Format: `1h`/`1m`/`1s`/`1ms`. MUST be >=1ms.'
                            type: string
                          percentage:
                            description: Percentage of requests to be faulted. Values
                              range between 0 and 100. If omitted all requests will
                              be faulted.
                            format: double
                            type: number
                        type: object
                      headerManipulation:
                        description: Manipulate request and response headers.
                        properties:
                          appendRequestHeaders:
                            additionalProperties:
                              type: string
                            description: Additional HTTP headers to add before forwarding
                              a request to the destination service.
                            type: object
                          appendResponseHeaders:
                            additionalProperties:
                              type: string
                            description: Additional HTTP headers to add before returning
                              a response to the caller.
                            type: object
                          removeRequestHeaders:
                            description: HTTP headers to remove before forwarding
                              a request to the destination service.
                            items:
                              type: string
                            type: array
                          removeResponseHeaders:
                            description: HTTP headers to remove before returning a
                              response to the caller.
                            items:
                              type: string
                            type: array
                        type: object
                      mirror:
                        description: Mirror traffic to a another destination (traffic
                          will be sent to its original destination in addition to
                          the mirrored destinations).
                        oneOf:
                        - not:
                            anyOf:
                            - required:
                              - kubeService
                        - required:
                          - kubeService
                        properties:
                          kubeService:
                            description: Reference (name, namespace, Gloo Mesh cluster)
                              to a Kubernetes service.
                            properties:
                              clusterName:
                                description: name of the cluster in which the resource
                                  exists
                                type: string
                              name:
                                description: name of the resource being referenced
                                type: string
                              namespace:
                                description: namespace of the resource being referenced
                                type: string
                            type: object
                          percentage:
                            description: Percentage of traffic to mirror. If omitted
                              all traffic will be mirrored. Values must be between
                              0 and 100.
                            format: double
                            type: number
                          port:
                            description: Port on the destination to receive traffic.
                              Required if the destination exposes multiple ports.
                            maximum: 4294967295
                            minimum: 0
                            type: integer
                        type: object
                      mtls:
                        description: Configure mTLS settings. If specified will override
                          global default defined in Settings.
                        properties:
                          istio:
                            description: Istio TLS settings.
                            properties:
                              tlsMode:
                                description: TLS connection mode
                                enum:
                                - DISABLE
                                - SIMPLE
                                - ISTIO_MUTUAL
                                type: string
                            type: object
                        type: object
                      outlierDetection:
                        description: |-
                          Configure [outlier detection](https://www.envoyproxy.io/docs/envoy/latest/intro/arch_overview/upstream/outlier) on the selected destinations.
                          Specifying this field requires an empty `source_selector` because it must apply to all traffic.
                        properties:
                          baseEjectionTime:
                            description: 'The minimum ejection duration. Format: `1h`/`1m`/`1s`/`1ms`.
                              Must be >= `1ms`. A default will be used if not set.'
                            type: string
                          consecutiveErrors:
                            description: The number of errors before a host is ejected
                              from the connection pool. A default will be used if
                              not set.
                            maximum: 4294967295
                            minimum: 0
                            type: integer
                          interval:
                            description: 'The time interval between ejection sweep
                              analysis. Format: `1h`/`1m`/`1s`/`1ms`. Must be >= `1ms`.
                              A default will be used if not set.'
                            type: string
                          maxEjectionPercent:
                            description: |-
                              The maximum percentage of hosts that can be ejected from the load balancing pool.
                              At least one host will be ejected regardless of the value. Must be between 0 and 100. A default will be used if not set.
                            maximum: 4294967295
                            minimum: 0
                            type: integer
                        type: object
                      rateLimit:
                        description: Config the Envoy based Ratelimit filter
                        oneOf:
                        - not:
                            anyOf:
                            - required:
                              - basic
                            - required:
                              - advanced
                            - required:
                              - configRefs
                        - required:
                          - basic
                        - required:
                          - advanced
                        - required:
                          - configRefs
                        properties:
                          advanced:
                            description: |-
                              Partial config for GlooE rate-limiting based on Envoy's rate-limit service;
                              supports Envoy's rate-limit service API. (reference here: https://github.com/lyft/ratelimit#configuration)
                              Configure rate-limit *actions* here, which define how request characteristics get translated into
                              descriptors used by the rate-limit service for rate-limiting. Configure rate-limit *descriptors* and
                              their associated limits on the Gloo settings.
                              Only one of `ratelimit` or `rate_limit_configs` can be set.
                            properties:
                              actions:
                                description: |-
                                  Define individual rate limits here. Each rate limit will be evaluated, if any rate limit
                                  would be throttled, the entire request returns a 429 (gets throttled)
                                items:
                                  properties:
                                    actions:
                                      description: 'TODO: come up with descriptive
                                        names and comments for these fields'
                                      items:
                                        oneOf:
                                        - not:
                                            anyOf:
                                            - required:
                                              - sourceCluster
                                            - required:
                                              - destinationCluster
                                            - required:
                                              - requestHeaders
                                            - required:
                                              - remoteAddress
                                            - required:
                                              - genericKey
                                            - required:
                                              - headerValueMatch
                                        - required:
                                          - sourceCluster
                                        - required:
                                          - destinationCluster
                                        - required:
                                          - requestHeaders
                                        - required:
                                          - remoteAddress
                                        - required:
                                          - genericKey
                                        - required:
                                          - headerValueMatch
                                        properties:
                                          destinationCluster:
                                            description: Rate limit on destination
                                              cluster.
                                            type: object
                                          genericKey:
                                            description: Rate limit on a generic key.
                                            properties:
                                              descriptorValue:
                                                description: The value to use in the
                                                  descriptor entry.
                                                type: string
                                            type: object
                                          headerValueMatch:
                                            description: Rate limit on the existence
                                              of request headers.
                                            properties:
                                              descriptorValue:
                                                description: The value to use in the
                                                  descriptor entry.
                                                type: string
                                              expectMatch:
                                                description: |-
                                                  If set to true, the action will append a descriptor entry when the
                                                  request matches the headers. If set to false, the action will append a
                                                  descriptor entry when the request does not match the headers. The
                                                  default value is true.
                                                nullable: true
                                                type: boolean
                                              headers:
                                                description: |-
                                                  Specifies a set of headers that the rate limit action should match
                                                  on. The action will check the request’s headers against all the
                                                  specified headers in the config. A match will happen if all the
                                                  headers in the config are present in the request with the same values
                                                  (or based on presence if the value field is not in the config).
                                                items:
                                                  oneOf:
                                                  - not:
                                                      anyOf:
                                                      - required:
                                                        - exactMatch
                                                      - required:
                                                        - regexMatch
                                                      - required:
                                                        - rangeMatch
                                                      - required:
                                                        - presentMatch
                                                      - required:
                                                        - prefixMatch
                                                      - required:
                                                        - suffixMatch
                                                  - required:
                                                    - exactMatch
                                                  - required:
                                                    - regexMatch
                                                  - required:
                                                    - rangeMatch
                                                  - required:
                                                    - presentMatch
                                                  - required:
                                                    - prefixMatch
                                                  - required:
                                                    - suffixMatch
                                                  properties:
                                                    exactMatch:
                                                      description: If specified, header
                                                        match will be performed based
                                                        on the value of the header.
                                                      type: string
                                                    invertMatch:
                                                      description: |-
                                                        If specified, the match result will be inverted before checking. Defaults to false.

                                                        Examples:

                                                        * The regex *\d{3}* does not match the value *1234*, so it will match when inverted.
                                                        * The range [-10,0) will match the value -1, so it will not match when inverted.
                                                      type: boolean
                                                    name:
                                                      description: Specifies the name
                                                        of the header in the request.
                                                      type: string
                                                    prefixMatch:
                                                      description: |-
                                                        If specified, header match will be performed based on the prefix of the header value.
                                                        Note: empty prefix is not allowed, please use present_match instead.

                                                        Examples:

                                                        * The prefix *abcd* matches the value *abcdxyz*, but not for *abcxyz*.
                                                      type: string
                                                    presentMatch:
                                                      description: |-
                                                        If specified, header match will be performed based on whether the header is in the
                                                        request.
                                                      type: boolean
                                                    rangeMatch:
                                                      description: |-
                                                        If specified, header match will be performed based on range.
                                                        The rule will match if the request header value is within this range.
                                                        The entire request header value must represent an integer in base 10 notation: consisting of
                                                        an optional plus or minus sign followed by a sequence of digits. The rule will not match if
                                                        the header value does not represent an integer. Match will fail for empty values, floating
                                                        point numbers or if only a subsequence of the header value is an integer.

                                                        Examples:

                                                        * For range [-10,0), route will match for header value -1, but not for 0, "somestring", 10.9,
                                                          "-1somestring"
                                                      properties:
                                                        end:
                                                          description: end of the
                                                            range (exclusive)
                                                          format: int64
                                                          type: integer
                                                        start:
                                                          description: start of the
                                                            range (inclusive)
                                                          format: int64
                                                          type: integer
                                                      type: object
                                                    regexMatch:
                                                      description: |-
                                                        If specified, this regex string is a regular expression rule which implies the entire request
                                                        header value must match the regex. The rule will not match if only a subsequence of the
                                                        request header value matches the regex. The regex grammar used in the value field is defined
                                                        `(here)[https://en.cppreference.com/w/cpp/regex/ecmascript]`.

                                                        Examples:

                                                        * The regex *\d{3}* matches the value *123*
                                                        * The regex *\d{3}* does not match the value *1234*
                                                        * The regex *\d{3}* does not match the value *123.456*
                                                      type: string
                                                    suffixMatch:
                                                      description: |-
                                                        If specified, header match will be performed based on the suffix of the header value.
                                                        Note: empty suffix is not allowed, please use present_match instead.

                                                        Examples:

                                                        * The suffix *abcd* matches the value *xyzabcd*, but not for *xyzbcd*.
                                                      type: string
                                                  type: object
                                                type: array
                                            type: object
                                          remoteAddress:
                                            description: Rate limit on remote address.
                                            type: object
                                          requestHeaders:
                                            description: Rate limit on request headers.
                                            properties:
                                              descriptorKey:
                                                description: The key to use in the
                                                  descriptor entry.
                                                type: string
                                              headerName:
                                                description: |-
                                                  The header name to be queried from the request headers. The header’s
                                                  value is used to populate the value of the descriptor entry for the
                                                  descriptor_key.
                                                type: string
                                            type: object
                                          sourceCluster:
                                            description: Rate limit on source cluster.
                                            type: object
                                        type: object
                                      type: array
                                    setActions:
                                      items:
                                        oneOf:
                                        - not:
                                            anyOf:
                                            - required:
                                              - sourceCluster
                                            - required:
                                              - destinationCluster
                                            - required:
                                              - requestHeaders
                                            - required:
                                              - remoteAddress
                                            - required:
                                              - genericKey
                                            - required:
                                              - headerValueMatch
                                        - required:
                                          - sourceCluster
                                        - required:
                                          - destinationCluster
                                        - required:
                                          - requestHeaders
                                        - required:
                                          - remoteAddress
                                        - required:
                                          - genericKey
                                        - required:
                                          - headerValueMatch
                                        properties:
                                          destinationCluster:
                                            description: Rate limit on destination
                                              cluster.
                                            type: object
                                          genericKey:
                                            description: Rate limit on a generic key.
                                            properties:
                                              descriptorValue:
                                                description: The value to use in the
                                                  descriptor entry.
                                                type: string
                                            type: object
                                          headerValueMatch:
                                            description: Rate limit on the existence
                                              of request headers.
                                            properties:
                                              descriptorValue:
                                                description: The value to use in the
                                                  descriptor entry.
                                                type: string
                                              expectMatch:
                                                description: |-
                                                  If set to true, the action will append a descriptor entry when the
                                                  request matches the headers. If set to false, the action will append a
                                                  descriptor entry when the request does not match the headers. The
                                                  default value is true.
                                                nullable: true
                                                type: boolean
                                              headers:
                                                description: |-
                                                  Specifies a set of headers that the rate limit action should match
                                                  on. The action will check the request’s headers against all the
                                                  specified headers in the config. A match will happen if all the
                                                  headers in the config are present in the request with the same values
                                                  (or based on presence if the value field is not in the config).
                                                items:
                                                  oneOf:
                                                  - not:
                                                      anyOf:
                                                      - required:
                                                        - exactMatch
                                                      - required:
                                                        - regexMatch
                                                      - required:
                                                        - rangeMatch
                                                      - required:
                                                        - presentMatch
                                                      - required:
                                                        - prefixMatch
                                                      - required:
                                                        - suffixMatch
                                                  - required:
                                                    - exactMatch
                                                  - required:
                                                    - regexMatch
                                                  - required:
                                                    - rangeMatch
                                                  - required:
                                                    - presentMatch
                                                  - required:
                                                    - prefixMatch
                                                  - required:
                                                    - suffixMatch
                                                  properties:
                                                    exactMatch:
                                                      description: If specified, header
                                                        match will be performed based
                                                        on the value of the header.
                                                      type: string
                                                    invertMatch:
                                                      description: |-
                                                        If specified, the match result will be inverted before checking. Defaults to false.

                                                        Examples:

                                                        * The regex *\d{3}* does not match the value *1234*, so it will match when inverted.
                                                        * The range [-10,0) will match the value -1, so it will not match when inverted.
                                                      type: boolean
                                                    name:
                                                      description: Specifies the name
                                                        of the header in the request.
                                                      type: string
                                                    prefixMatch:
                                                      description: |-
                                                        If specified, header match will be performed based on the prefix of the header value.
                                                        Note: empty prefix is not allowed, please use present_match instead.

                                                        Examples:

                                                        * The prefix *abcd* matches the value *abcdxyz*, but not for *abcxyz*.
                                                      type: string
                                                    presentMatch:
                                                      description: |-
                                                        If specified, header match will be performed based on whether the header is in the
                                                        request.
                                                      type: boolean
                                                    rangeMatch:
                                                      description: |-
                                                        If specified, header match will be performed based on range.
                                                        The rule will match if the request header value is within this range.
                                                        The entire request header value must represent an integer in base 10 notation: consisting of
                                                        an optional plus or minus sign followed by a sequence of digits. The rule will not match if
                                                        the header value does not represent an integer. Match will fail for empty values, floating
                                                        point numbers or if only a subsequence of the header value is an integer.

                                                        Examples:

                                                        * For range [-10,0), route will match for header value -1, but not for 0, "somestring", 10.9,
                                                          "-1somestring"
                                                      properties:
                                                        end:
                                                          description: end of the
                                                            range (exclusive)
                                                          format: int64
                                                          type: integer
                                                        start:
                                                          description: start of the
                                                            range (inclusive)
                                                          format: int64
                                                          type: integer
                                                      type: object
                                                    regexMatch:
                                                      description: |-
                                                        If specified, this regex string is a regular expression rule which implies the entire request
                                                        header value must match the regex. The rule will not match if only a subsequence of the
                                                        request header value matches the regex. The regex grammar used in the value field is defined
                                                        `(here)[https://en.cppreference.com/w/cpp/regex/ecmascript]`.

                                                        Examples:

                                                        * The regex *\d{3}* matches the value *123*
                                                        * The regex *\d{3}* does not match the value *1234*
                                                        * The regex *\d{3}* does not match the value *123.456*
                                                      type: string
                                                    suffixMatch:
                                                      description: |-
                                                        If specified, header match will be performed based on the suffix of the header value.
                                                        Note: empty suffix is not allowed, please use present_match instead.

                                                        Examples:

                                                        * The suffix *abcd* matches the value *xyzabcd*, but not for *xyzbcd*.
                                                      type: string
                                                  type: object
                                                type: array
                                            type: object
                                          remoteAddress:
                                            description: Rate limit on remote address.
                                            type: object
                                          requestHeaders:
                                            description: Rate limit on request headers.
                                            properties:
                                              descriptorKey:
                                                description: The key to use in the
                                                  descriptor entry.
                                                type: string
                                              headerName:
                                                description: |-
                                                  The header name to be queried from the request headers. The header’s
                                                  value is used to populate the value of the descriptor entry for the
                                                  descriptor_key.
                                                type: string
                                            type: object
                                          sourceCluster:
                                            description: Rate limit on source cluster.
                                            type: object
                                        type: object
                                      type: array
                                  type: object
                                type: array
                            type: object
                          basic:
                            description: Config for rate-limiting using simplified
                              (gloo-specific) API
                            properties:
                              anonymousLimits:
                                description: limits for unauthorized users
                                properties:
                                  requestsPerUnit:
                                    maximum: 4294967295
                                    minimum: 0
                                    type: integer
                                  unit:
                                    enum:
                                    - UNKNOWN
                                    - SECOND
                                    - MINUTE
                                    - HOUR
                                    - DAY
                                    type: string
                                type: object
                              authorizedLimits:
                                description: limits for authorized users
                                properties:
                                  requestsPerUnit:
                                    maximum: 4294967295
                                    minimum: 0
                                    type: integer
                                  unit:
                                    enum:
                                    - UNKNOWN
                                    - SECOND
                                    - MINUTE
                                    - HOUR
                                    - DAY
                                    type: string
                                type: object
                            type: object
                          configRefs:
                            description: |-
                              References to RateLimitConfig resources. This is used to configure the GlooE rate limit server.
                              Only one of `ratelimit` or `rate_limit_configs` can be set.
                            properties:
                              refs:
                                items:
                                  properties:
                                    name:
                                      description: name of the resource being referenced
                                      type: string
                                    namespace:
                                      description: namespace of the resource being
                                        referenced
                                      type: string
                                  type: object
                                type: array
                            type: object
                        type: object
                      requestTimeout:
                        description: Set a timeout on requests.
                        type: string
                      retries:
                        description: Set a retry policy on requests.
                        properties:
                          attempts:
                            description: Number of retries for a given request
                            format: int32
                            type: integer
                          perTryTimeout:
                            description: 'Timeout per retry attempt for a given request.
                              Format: `1h`/`1m`/`1s`/`1ms`. *Must be >= 1ms*.'
                            type: string
                        type: object
                      trafficShift:
                        description: Shift traffic to a different destination.
                        properties:
                          destinations:
                            description: Specify weighted traffic shift destinations.
                            items:
                              oneOf:
                              - not:
                                  anyOf:
                                  - required:
                                    - kubeService
                                  - required:
                                    - virtualDestination
                                  - required:
                                    - staticDestination
                                  - required:
                                    - clusterHeader
                              - required:
                                - kubeService
                              - required:
                                - virtualDestination
                              - required:
                                - staticDestination
                              - required:
                                - clusterHeader
                              properties:
                                clusterHeader:
                                  description: |-
                                    Envoy will determine the cluster to route to by reading the value of the HTTP header named by cluster_header from the request headers.
                                    If the header is not found or the referenced cluster does not exist, Envoy will return a 404 response.
                                    Avoid using this whenever possible, it does not allow for custom filter configuration based on Virtual Host.
                                    {{/* NOTE: unimplemented */}}
                                  type: string
                                kubeService:
                                  description: Specify a Kubernetes Service.
                                  properties:
                                    clusterName:
                                      description: The Gloo Mesh cluster name (registration
                                        name) of the service.
                                      type: string
                                    name:
                                      description: The name of the service.
                                      type: string
                                    namespace:
                                      description: The namespace of the service.
                                      type: string
                                    port:
                                      description: Port on the service to receive
                                        traffic. Required if the service exposes more
                                        than one port.
                                      maximum: 4294967295
                                      minimum: 0
                                      type: integer
                                    subset:
                                      additionalProperties:
                                        type: string
                                      description: Specify, by labels, a subset of
                                        service instances to route to.
                                      type: object
                                  type: object
                                options:
                                  description: |-
                                    additional options / config for a route which will be applied
                                    when this destination is selected.
                                  properties:
                                    headerManipulation:
                                      description: manipualte headers on traffic sent
                                        to this destination
                                      properties:
                                        appendRequestHeaders:
                                          additionalProperties:
                                            type: string
                                          description: Additional HTTP headers to
                                            add before forwarding a request to the
                                            destination service.
                                          type: object
                                        appendResponseHeaders:
                                          additionalProperties:
                                            type: string
                                          description: Additional HTTP headers to
                                            add before returning a response to the
                                            caller.
                                          type: object
                                        removeRequestHeaders:
                                          description: HTTP headers to remove before
                                            forwarding a request to the destination
                                            service.
                                          items:
                                            type: string
                                          type: array
                                        removeResponseHeaders:
                                          description: HTTP headers to remove before
                                            returning a response to the caller.
                                          items:
                                            type: string
                                          type: array
                                      type: object
                                  type: object
                                staticDestination:
                                  description: Reference to a gloo mesh Static Destination
                                  properties:
                                    name:
                                      description: name of the resource being referenced
                                      type: string
                                    namespace:
                                      description: namespace of the resource being
                                        referenced
                                      type: string
                                  type: object
                                virtualDestination:
                                  description: Specify a VirtualDestination.
                                  properties:
                                    name:
                                      description: The name of the VirtualDestination
                                        object.
                                      type: string
                                    namespace:
                                      description: The namespace of the VirtualDestination
                                        object.
                                      type: string
                                    subset:
                                      additionalProperties:
                                        type: string
                                      description: Specify, by labels, a subset of
                                        service instances backing the VirtualDestination
                                        to route to.
                                      type: object
                                  type: object
                                weight:
                                  description: |-
                                    Specify the proportion of traffic to be forwarded to this destination.
                                    Weights across all of the `destinations` must sum to 100.
                                  maximum: 4294967295
                                  minimum: 0
                                  type: integer
                              type: object
                            type: array
                        type: object
                    type: object
                  redirectAction:
                    description: Redirect actions tell the proxy to return a redirect
                      response to the downstream client.
                    properties:
                      hostRedirect:
                        description: The host portion of the URL will be swapped with
                          this value.
                        type: string
                      httpsRedirect:
                        description: The scheme portion of the URL will be swapped
                          with "https".
                        type: boolean
                      pathRedirect:
                        description: The path portion of the URL will be swapped with
                          this value.
                        type: string
                      prefixRewrite:
                        description: |-
                          Indicates that during redirection, the matched prefix (or path)
                          should be swapped with this value. This option allows redirect URLs be dynamically created
                          based on the request.

                            Pay attention to the use of trailing slashes as mentioned in
                            `RouteAction`'s `prefix_rewrite`.
                        type: string
                      responseCode:
                        description: |-
                          The HTTP status code to use in the redirect response. The default response
                          code is MOVED_PERMANENTLY (301).
                        enum:
                        - MOVED_PERMANENTLY
                        - FOUND
                        - SEE_OTHER
                        - TEMPORARY_REDIRECT
                        - PERMANENT_REDIRECT
                        type: string
                      stripQuery:
                        description: |-
                          Indicates that during redirection, the query portion of the URL will
                          be removed. Default value is false.
                        type: boolean
                    type: object
                  routeAction:
                    description: |-
                      This action is the primary action to be selected for most routes. The RouteAction tells the proxy to
                      route requests to an upstream.
                    properties:
                      destinations:
                        description: |-
                          Defines the destination upstream for routing
                          Some destinations require additional configuration for the route (e.g. AWS upstreams require a function name
                          to be specified).
                        items:
                          oneOf:
                          - not:
                              anyOf:
                              - required:
                                - kubeService
                              - required:
                                - virtualDestination
                              - required:
                                - staticDestination
                              - required:
                                - clusterHeader
                          - required:
                            - kubeService
                          - required:
                            - virtualDestination
                          - required:
                            - staticDestination
                          - required:
                            - clusterHeader
                          properties:
                            clusterHeader:
                              description: |-
                                Envoy will determine the cluster to route to by reading the value of the HTTP header named by cluster_header from the request headers.
                                If the header is not found or the referenced cluster does not exist, Envoy will return a 404 response.
                                Avoid using this whenever possible, it does not allow for custom filter configuration based on Virtual Host.
                                {{/* NOTE: unimplemented */}}
                              type: string
                            kubeService:
                              description: Specify a Kubernetes Service.
                              properties:
                                clusterName:
                                  description: The Gloo Mesh cluster name (registration
                                    name) of the service.
                                  type: string
                                name:
                                  description: The name of the service.
                                  type: string
                                namespace:
                                  description: The namespace of the service.
                                  type: string
                                port:
                                  description: Port on the service to receive traffic.
                                    Required if the service exposes more than one
                                    port.
                                  maximum: 4294967295
                                  minimum: 0
                                  type: integer
                                subset:
                                  additionalProperties:
                                    type: string
                                  description: Specify, by labels, a subset of service
                                    instances to route to.
                                  type: object
                              type: object
                            options:
                              description: |-
                                additional options / config for a route which will be applied
                                when this destination is selected.
                              properties:
                                headerManipulation:
                                  description: manipualte headers on traffic sent
                                    to this destination
                                  properties:
                                    appendRequestHeaders:
                                      additionalProperties:
                                        type: string
                                      description: Additional HTTP headers to add
                                        before forwarding a request to the destination
                                        service.
                                      type: object
                                    appendResponseHeaders:
                                      additionalProperties:
                                        type: string
                                      description: Additional HTTP headers to add
                                        before returning a response to the caller.
                                      type: object
                                    removeRequestHeaders:
                                      description: HTTP headers to remove before forwarding
                                        a request to the destination service.
                                      items:
                                        type: string
                                      type: array
                                    removeResponseHeaders:
                                      description: HTTP headers to remove before returning
                                        a response to the caller.
                                      items:
                                        type: string
                                      type: array
                                  type: object
                              type: object
                            staticDestination:
                              description: Reference to a gloo mesh Static Destination
                              properties:
                                name:
                                  description: name of the resource being referenced
                                  type: string
                                namespace:
                                  description: namespace of the resource being referenced
                                  type: string
                              type: object
                            virtualDestination:
                              description: Specify a VirtualDestination.
                              properties:
                                name:
                                  description: The name of the VirtualDestination
                                    object.
                                  type: string
                                namespace:
                                  description: The namespace of the VirtualDestination
                                    object.
                                  type: string
                                subset:
                                  additionalProperties:
                                    type: string
                                  description: Specify, by labels, a subset of service
                                    instances backing the VirtualDestination to route
                                    to.
                                  type: object
                              type: object
                            weight:
                              description: |-
                                Specify the proportion of traffic to be forwarded to this destination.
                                Weights across all of the `destinations` must sum to 100.
                              maximum: 4294967295
                              minimum: 0
                              type: integer
                          type: object
                        type: array
                    type: object
                type: object
              type: array
          type: object
        status:
          properties:
            attachedVirtualGateways:
              description: List of each VirtualGateway which has selected this VirtualHost
              items:
                properties:
                  name:
                    description: name of the resource being referenced
                    type: string
                  namespace:
                    description: namespace of the resource being referenced
                    type: string
                type: object
              type: array
            errors:
              description: Any errors found while processing this generation of the
                resource.
              items:
                type: string
              type: array
            observedGeneration:
              description: |-
                The most recent generation observed in the the VirtualHost metadata.
                If the `observedGeneration` does not match `metadata.generation`,
                Gloo Mesh has not processed the most recent version of this resource.
              format: int64
              type: integer
            selectedRouteTables:
              description: List of RouteTables that this Route table delegates to
              items:
                properties:
                  name:
                    description: name of the resource being referenced
                    type: string
                  namespace:
                    description: namespace of the resource being referenced
                    type: string
                type: object
              type: array
            warnings:
              description: Any warnings found while processing this generation of
                the resource.
              items:
                type: string
              type: array
          type: object
      type: object
  versions:
  - name: v1beta1
    served: true
    storage: true

---
apiVersion: apiextensions.k8s.io/v1beta1
kind: CustomResourceDefinition
metadata:
  labels:
    app: gloo-mesh
    app.kubernetes.io/name: gloo-mesh
  name: routetables.networking.enterprise.mesh.gloo.solo.io
spec:
  group: networking.enterprise.mesh.gloo.solo.io
  names:
    kind: RouteTable
    listKind: RouteTableList
    plural: routetables
    singular: routetable
  preserveUnknownFields: false
  scope: Namespaced
  subresources:
    status: {}
  validation:
    openAPIV3Schema:
      properties:
        spec:
          description: |-
            RouteTable is a resource which can be referenced either from the top level VirtualHost resource, or from
               other RouteTables. It's primary use is to organizationally and logically separate the configuration of Routes,
               so that the responsibilities of Route configuration and maintenance can be divided between teams where appropriate.
          properties:
            routes:
              description: |-
                The list of HTTP Routes define routing actions to be taken for incoming HTTP requests whose host header matches
                this virtual host. If the request matches more than one Route in the list, the first Route matched will be selected.
                If the list of Routes is empty, the virtual host will be ignored by Gloo.
              items:
                oneOf:
                - not:
                    anyOf:
                    - required:
                      - routeAction
                    - properties:
                        redirectAction:
                          oneOf:
                          - not:
                              anyOf:
                              - required:
                                - pathRedirect
                              - required:
                                - prefixRewrite
                          - required:
                            - pathRedirect
                          - required:
                            - prefixRewrite
                      required:
                      - redirectAction
                    - required:
                      - directResponseAction
                    - required:
                      - delegateAction
                - required:
                  - routeAction
                - properties:
                    redirectAction:
                      oneOf:
                      - not:
                          anyOf:
                          - required:
                            - pathRedirect
                          - required:
                            - prefixRewrite
                      - required:
                        - pathRedirect
                      - required:
                        - prefixRewrite
                  required:
                  - redirectAction
                - required:
                  - directResponseAction
                - required:
                  - delegateAction
                properties:
                  delegateAction:
                    description: Delegate routing actions for the given matcher to
                      one or more RouteTables.
                    properties:
                      refs:
                        description: Delegate to the RouteTable resources with matching
                          `name` and `namespace`.
                        items:
                          properties:
                            name:
                              description: name of the resource being referenced
                              type: string
                            namespace:
                              description: namespace of the resource being referenced
                              type: string
                          type: object
                        type: array
                      selector:
                        description: Delegate to the RouteTables that match the given
                          selector.
                        properties:
                          expressions:
                            description: |-
                              Expressions allow for more flexible object label matching, such as equality-based requirements, set-based requirements, or a combination of both.
                              https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/#equality-based-requirement
                            items:
                              properties:
                                key:
                                  description: |-
                                    Kubernetes label key, must conform to Kubernetes syntax requirements
                                    https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/#syntax-and-character-set
                                  type: string
                                operator:
                                  description: The operator can only be in, notin,
                                    =, ==, !=, exists, ! (DoesNotExist), gt (GreaterThan),
                                    lt (LessThan).
                                  enum:
                                  - Equals
                                  - DoubleEquals
                                  - NotEquals
                                  - In
                                  - NotIn
                                  - Exists
                                  - DoesNotExist
                                  - GreaterThan
                                  - LessThan
                                  type: string
                                values:
                                  items:
                                    type: string
                                  type: array
                              type: object
                            type: array
                          labels:
                            additionalProperties:
                              type: string
                            description: Select objects whose labels match the ones
                              specified here.
                            type: object
                          namespaces:
                            description: |-
                              Select Objects in these namespaces. If omitted, Gloo Mesh will only select Objects in the same namespace
                              as the parent resource (e.g. VirtualGateway) that owns this selector.
                              The reserved value "*" can be used to select objects in all namespaces watched by Gloo Mesh.
                            items:
                              type: string
                            type: array
                        type: object
                    type: object
                  directResponseAction:
                    description: Return an arbitrary HTTP response directly, without
                      proxying.
                    properties:
                      body:
                        description: |-
                          Specifies the content of the response body. If this setting is omitted,
                          no body is included in the generated response.

                          Note: Headers can be specified using the Header Modification feature in the enclosing
                          Route, ConnectionHandler, or Gateway options.
                        type: string
                      status:
                        description: Specifies the HTTP response status to be returned.
                        maximum: 4294967295
                        minimum: 0
                        type: integer
                    type: object
                  matchers:
                    description: |-
                      Matchers contain parameters for matching requests (i.e., based on HTTP path, headers, etc.).
                      If empty, the route will match all requests (i.e, a single "/" path prefix matcher).
                      For delegated routes, any parent matcher must have a `prefix` path matcher.
                    items:
                      properties:
                        headers:
                          description: Specify a set of headers which requests must
                            match in entirety (all headers must match).
                          items:
                            properties:
                              invertMatch:
                                description: |-
                                  If set to true, the result of the match will be inverted. Defaults to false.

                                     Examples:

                                         - name=foo, invert_match=true: matches if no header named `foo` is present
                                         - name=foo, value=bar, invert_match=true: matches if no header named `foo` with value `bar` is present
                                         - name=foo, value=``\d{3}``, regex=true, invert_match=true: matches if no header named `foo` with a value consisting of three integers is present.
                                type: boolean
                              name:
                                description: Specify the name of the header in the
                                  request.
                                type: string
                              regex:
                                description: Specify whether the header value should
                                  be treated as regex.
                                type: boolean
                              value:
                                description: |-
                                  Specify the value of the header. If the value is absent a request that
                                  has the name header will match, regardless of the header’s value.
                                type: string
                            type: object
                          type: array
                        method:
                          description: Specify an HTTP method to match against.
                          type: string
                        name:
                          description: |-
                            The name assigned to a match. The match's name will be
                            concatenated with the parent route's name and will be logged in
                            the access logs for requests matching this route.
                          type: string
                        queryParameters:
                          description: Specify a set of URL query parameters which
                            requests must match in entirety (all query params must
                            match).
                          items:
                            properties:
                              name:
                                description: Specify the name of a key that must be
                                  present in the requested path's query string.
                                type: string
                              regex:
                                description: If true, treat `value` as a regular expression.
                                type: boolean
                              value:
                                description: Specify the value of the query parameter
                                  keyed on `name`.
                                type: string
                            type: object
                          type: array
                        uri:
                          description: Specify match criteria against the targeted
                            path.
                          oneOf:
                          - not:
                              anyOf:
                              - required:
                                - exact
                              - required:
                                - prefix
                              - required:
                                - regex
                              - required:
                                - suffix
                          - required:
                            - exact
                          - required:
                            - prefix
                          - required:
                            - regex
                          - required:
                            - suffix
                          properties:
                            exact:
                              description: Exact string match.
                              type: string
                            ignoreCase:
                              description: If true, indicates the exact/prefix/suffix
                                matching should be case insensitive. This has no effect
                                for the regex match.
                              type: boolean
                            prefix:
                              description: Prefix-based match.
                              type: string
                            regex:
                              description: ECMAscript style regex-based match.
                              type: string
                            suffix:
                              description: Suffix-based match.
                              type: string
                          type: object
                      type: object
                    type: array
                  name:
                    description: |-
                      The name provides a convenience for users to be able to refer to a route by name.
                      It includes names of VS, Route, and RouteTable ancestors of the Route.
                    type: string
                  options:
                    description: |-
                      Route Options extend the behavior of routes.
                      Route options include configuration such as retries, rate limiting, and request/response transformation.
                      RouteOption behavior will be inherited by delegated routes which do not specify their own `options`
                    properties:
                      corsPolicy:
                        description: |-
                          Set a Cross-Origin Resource Sharing policy (CORS) for requests. Refer to [this link](https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS)
                          for further details about cross origin resource sharing.
                        properties:
                          allowCredentials:
                            description: |-
                              Indicates whether the caller is allowed to send the actual request
                              (not the preflight) using credentials. Translates to the
                              `Access-Control-Allow-Credentials` header.
                            nullable: true
                            type: boolean
                          allowHeaders:
                            description: |-
                              List of HTTP headers that can be used when requesting the
                              resource. Serialized to the `Access-Control-Allow-Headers` header.
                            items:
                              type: string
                            type: array
                          allowMethods:
                            description: |-
                              List of HTTP methods allowed to access the resource. The content will
                              be serialized to the `Access-Control-Allow-Methods` header.
                            items:
                              type: string
                            type: array
                          allowOrigins:
                            description: String patterns that match allowed origins.
                              An origin is allowed if any of the string matchers match.
                            items:
                              oneOf:
                              - not:
                                  anyOf:
                                  - required:
                                    - exact
                                  - required:
                                    - prefix
                                  - required:
                                    - regex
                                  - required:
                                    - suffix
                              - required:
                                - exact
                              - required:
                                - prefix
                              - required:
                                - regex
                              - required:
                                - suffix
                              properties:
                                exact:
                                  description: Exact string match.
                                  type: string
                                ignoreCase:
                                  description: If true, indicates the exact/prefix/suffix
                                    matching should be case insensitive. This has
                                    no effect for the regex match.
                                  type: boolean
                                prefix:
                                  description: Prefix-based match.
                                  type: string
                                regex:
                                  description: ECMAscript style regex-based match.
                                  type: string
                                suffix:
                                  description: Suffix-based match.
                                  type: string
                              type: object
                            type: array
                          exposeHeaders:
                            description: |-
                              A list of HTTP headers that browsers are allowed to
                              access. Serialized to the `Access-Control-Expose-Headers` header.
                            items:
                              type: string
                            type: array
                          maxAge:
                            description: |-
                              Specify how long the results of a preflight request can be
                              cached. Serialized to the `Access-Control-Max-Age` header.
                            type: string
                        type: object
                      csrf:
                        description: Configure the Envoy based CSRF filter
                        properties:
                          additionalOrigins:
                            description: |-
                              Specifies additional source origins that will be allowed in addition to
                              the destination origin.
                            items:
                              oneOf:
                              - not:
                                  anyOf:
                                  - required:
                                    - exact
                                  - required:
                                    - prefix
                                  - required:
                                    - regex
                                  - required:
                                    - suffix
                              - required:
                                - exact
                              - required:
                                - prefix
                              - required:
                                - regex
                              - required:
                                - suffix
                              properties:
                                exact:
                                  description: Exact string match.
                                  type: string
                                ignoreCase:
                                  description: If true, indicates the exact/prefix/suffix
                                    matching should be case insensitive. This has
                                    no effect for the regex match.
                                  type: boolean
                                prefix:
                                  description: Prefix-based match.
                                  type: string
                                regex:
                                  description: ECMAscript style regex-based match.
                                  type: string
                                suffix:
                                  description: Suffix-based match.
                                  type: string
                              type: object
                            type: array
                          filterEnabled:
                            description: Specifies that CSRF policies will be evaluated,
                              tracked and enforced.
                            type: boolean
                          percentage:
                            description: |-
                              Specifies the % of requests for which the CSRF filter is enabled or when shadow mode is enabled the % of requests
                              evaluated and tracked, but not enforced.

                              If filter_enabled or shadow_enabled is true.
                              Envoy will lookup the runtime key to get the percentage of requests to filter.

                              .. note:: This field defaults to 100
                            format: double
                            type: number
                          shadowEnabled:
                            description: |-
                              Specifies that CSRF policies will be evaluated and tracked, but not enforced.

                              This is intended to be used when ``filter_enabled`` is false and will be ignored otherwise.
                            type: boolean
                        type: object
                      faultInjection:
                        description: Inject faulty responses.
                        oneOf:
                        - not:
                            anyOf:
                            - required:
                              - fixedDelay
                            - required:
                              - abort
                        - required:
                          - fixedDelay
                        - required:
                          - abort
                        properties:
                          abort:
                            description: Abort the request and return the specified
                              error code back to traffic source.
                            properties:
                              httpStatus:
                                description: Required. HTTP status code to use to
                                  abort the request.
                                format: int32
                                type: integer
                            type: object
                          fixedDelay:
                            description: 'Add a delay of a fixed duration before sending
                              the request. Format: `1h`/`1m`/`1s`/`1ms`. MUST be >=1ms.'
                            type: string
                          percentage:
                            description: Percentage of requests to be faulted. Values
                              range between 0 and 100. If omitted all requests will
                              be faulted.
                            format: double
                            type: number
                        type: object
                      headerManipulation:
                        description: Manipulate request and response headers.
                        properties:
                          appendRequestHeaders:
                            additionalProperties:
                              type: string
                            description: Additional HTTP headers to add before forwarding
                              a request to the destination service.
                            type: object
                          appendResponseHeaders:
                            additionalProperties:
                              type: string
                            description: Additional HTTP headers to add before returning
                              a response to the caller.
                            type: object
                          removeRequestHeaders:
                            description: HTTP headers to remove before forwarding
                              a request to the destination service.
                            items:
                              type: string
                            type: array
                          removeResponseHeaders:
                            description: HTTP headers to remove before returning a
                              response to the caller.
                            items:
                              type: string
                            type: array
                        type: object
                      mirror:
                        description: Mirror traffic to a another destination (traffic
                          will be sent to its original destination in addition to
                          the mirrored destinations).
                        oneOf:
                        - not:
                            anyOf:
                            - required:
                              - kubeService
                        - required:
                          - kubeService
                        properties:
                          kubeService:
                            description: Reference (name, namespace, Gloo Mesh cluster)
                              to a Kubernetes service.
                            properties:
                              clusterName:
                                description: name of the cluster in which the resource
                                  exists
                                type: string
                              name:
                                description: name of the resource being referenced
                                type: string
                              namespace:
                                description: namespace of the resource being referenced
                                type: string
                            type: object
                          percentage:
                            description: Percentage of traffic to mirror. If omitted
                              all traffic will be mirrored. Values must be between
                              0 and 100.
                            format: double
                            type: number
                          port:
                            description: Port on the destination to receive traffic.
                              Required if the destination exposes multiple ports.
                            maximum: 4294967295
                            minimum: 0
                            type: integer
                        type: object
                      mtls:
                        description: Configure mTLS settings. If specified will override
                          global default defined in Settings.
                        properties:
                          istio:
                            description: Istio TLS settings.
                            properties:
                              tlsMode:
                                description: TLS connection mode
                                enum:
                                - DISABLE
                                - SIMPLE
                                - ISTIO_MUTUAL
                                type: string
                            type: object
                        type: object
                      outlierDetection:
                        description: |-
                          Configure [outlier detection](https://www.envoyproxy.io/docs/envoy/latest/intro/arch_overview/upstream/outlier) on the selected destinations.
                          Specifying this field requires an empty `source_selector` because it must apply to all traffic.
                        properties:
                          baseEjectionTime:
                            description: 'The minimum ejection duration. Format: `1h`/`1m`/`1s`/`1ms`.
                              Must be >= `1ms`. A default will be used if not set.'
                            type: string
                          consecutiveErrors:
                            description: The number of errors before a host is ejected
                              from the connection pool. A default will be used if
                              not set.
                            maximum: 4294967295
                            minimum: 0
                            type: integer
                          interval:
                            description: 'The time interval between ejection sweep
                              analysis. Format: `1h`/`1m`/`1s`/`1ms`. Must be >= `1ms`.
                              A default will be used if not set.'
                            type: string
                          maxEjectionPercent:
                            description: |-
                              The maximum percentage of hosts that can be ejected from the load balancing pool.
                              At least one host will be ejected regardless of the value. Must be between 0 and 100. A default will be used if not set.
                            maximum: 4294967295
                            minimum: 0
                            type: integer
                        type: object
                      rateLimit:
                        description: Config the Envoy based Ratelimit filter
                        oneOf:
                        - not:
                            anyOf:
                            - required:
                              - basic
                            - required:
                              - advanced
                            - required:
                              - configRefs
                        - required:
                          - basic
                        - required:
                          - advanced
                        - required:
                          - configRefs
                        properties:
                          advanced:
                            description: |-
                              Partial config for GlooE rate-limiting based on Envoy's rate-limit service;
                              supports Envoy's rate-limit service API. (reference here: https://github.com/lyft/ratelimit#configuration)
                              Configure rate-limit *actions* here, which define how request characteristics get translated into
                              descriptors used by the rate-limit service for rate-limiting. Configure rate-limit *descriptors* and
                              their associated limits on the Gloo settings.
                              Only one of `ratelimit` or `rate_limit_configs` can be set.
                            properties:
                              actions:
                                description: |-
                                  Define individual rate limits here. Each rate limit will be evaluated, if any rate limit
                                  would be throttled, the entire request returns a 429 (gets throttled)
                                items:
                                  properties:
                                    actions:
                                      description: 'TODO: come up with descriptive
                                        names and comments for these fields'
                                      items:
                                        oneOf:
                                        - not:
                                            anyOf:
                                            - required:
                                              - sourceCluster
                                            - required:
                                              - destinationCluster
                                            - required:
                                              - requestHeaders
                                            - required:
                                              - remoteAddress
                                            - required:
                                              - genericKey
                                            - required:
                                              - headerValueMatch
                                        - required:
                                          - sourceCluster
                                        - required:
                                          - destinationCluster
                                        - required:
                                          - requestHeaders
                                        - required:
                                          - remoteAddress
                                        - required:
                                          - genericKey
                                        - required:
                                          - headerValueMatch
                                        properties:
                                          destinationCluster:
                                            description: Rate limit on destination
                                              cluster.
                                            type: object
                                          genericKey:
                                            description: Rate limit on a generic key.
                                            properties:
                                              descriptorValue:
                                                description: The value to use in the
                                                  descriptor entry.
                                                type: string
                                            type: object
                                          headerValueMatch:
                                            description: Rate limit on the existence
                                              of request headers.
                                            properties:
                                              descriptorValue:
                                                description: The value to use in the
                                                  descriptor entry.
                                                type: string
                                              expectMatch:
                                                description: |-
                                                  If set to true, the action will append a descriptor entry when the
                                                  request matches the headers. If set to false, the action will append a
                                                  descriptor entry when the request does not match the headers. The
                                                  default value is true.
                                                nullable: true
                                                type: boolean
                                              headers:
                                                description: |-
                                                  Specifies a set of headers that the rate limit action should match
                                                  on. The action will check the request’s headers against all the
                                                  specified headers in the config. A match will happen if all the
                                                  headers in the config are present in the request with the same values
                                                  (or based on presence if the value field is not in the config).
                                                items:
                                                  oneOf:
                                                  - not:
                                                      anyOf:
                                                      - required:
                                                        - exactMatch
                                                      - required:
                                                        - regexMatch
                                                      - required:
                                                        - rangeMatch
                                                      - required:
                                                        - presentMatch
                                                      - required:
                                                        - prefixMatch
                                                      - required:
                                                        - suffixMatch
                                                  - required:
                                                    - exactMatch
                                                  - required:
                                                    - regexMatch
                                                  - required:
                                                    - rangeMatch
                                                  - required:
                                                    - presentMatch
                                                  - required:
                                                    - prefixMatch
                                                  - required:
                                                    - suffixMatch
                                                  properties:
                                                    exactMatch:
                                                      description: If specified, header
                                                        match will be performed based
                                                        on the value of the header.
                                                      type: string
                                                    invertMatch:
                                                      description: |-
                                                        If specified, the match result will be inverted before checking. Defaults to false.

                                                        Examples:

                                                        * The regex *\d{3}* does not match the value *1234*, so it will match when inverted.
                                                        * The range [-10,0) will match the value -1, so it will not match when inverted.
                                                      type: boolean
                                                    name:
                                                      description: Specifies the name
                                                        of the header in the request.
                                                      type: string
                                                    prefixMatch:
                                                      description: |-
                                                        If specified, header match will be performed based on the prefix of the header value.
                                                        Note: empty prefix is not allowed, please use present_match instead.

                                                        Examples:

                                                        * The prefix *abcd* matches the value *abcdxyz*, but not for *abcxyz*.
                                                      type: string
                                                    presentMatch:
                                                      description: |-
                                                        If specified, header match will be performed based on whether the header is in the
                                                        request.
                                                      type: boolean
                                                    rangeMatch:
                                                      description: |-
                                                        If specified, header match will be performed based on range.
                                                        The rule will match if the request header value is within this range.
                                                        The entire request header value must represent an integer in base 10 notation: consisting of
                                                        an optional plus or minus sign followed by a sequence of digits. The rule will not match if
                                                        the header value does not represent an integer. Match will fail for empty values, floating
                                                        point numbers or if only a subsequence of the header value is an integer.

                                                        Examples:

                                                        * For range [-10,0), route will match for header value -1, but not for 0, "somestring", 10.9,
                                                          "-1somestring"
                                                      properties:
                                                        end:
                                                          description: end of the
                                                            range (exclusive)
                                                          format: int64
                                                          type: integer
                                                        start:
                                                          description: start of the
                                                            range (inclusive)
                                                          format: int64
                                                          type: integer
                                                      type: object
                                                    regexMatch:
                                                      description: |-
                                                        If specified, this regex string is a regular expression rule which implies the entire request
                                                        header value must match the regex. The rule will not match if only a subsequence of the
                                                        request header value matches the regex. The regex grammar used in the value field is defined
                                                        `(here)[https://en.cppreference.com/w/cpp/regex/ecmascript]`.

                                                        Examples:

                                                        * The regex *\d{3}* matches the value *123*
                                                        * The regex *\d{3}* does not match the value *1234*
                                                        * The regex *\d{3}* does not match the value *123.456*
                                                      type: string
                                                    suffixMatch:
                                                      description: |-
                                                        If specified, header match will be performed based on the suffix of the header value.
                                                        Note: empty suffix is not allowed, please use present_match instead.

                                                        Examples:

                                                        * The suffix *abcd* matches the value *xyzabcd*, but not for *xyzbcd*.
                                                      type: string
                                                  type: object
                                                type: array
                                            type: object
                                          remoteAddress:
                                            description: Rate limit on remote address.
                                            type: object
                                          requestHeaders:
                                            description: Rate limit on request headers.
                                            properties:
                                              descriptorKey:
                                                description: The key to use in the
                                                  descriptor entry.
                                                type: string
                                              headerName:
                                                description: |-
                                                  The header name to be queried from the request headers. The header’s
                                                  value is used to populate the value of the descriptor entry for the
                                                  descriptor_key.
                                                type: string
                                            type: object
                                          sourceCluster:
                                            description: Rate limit on source cluster.
                                            type: object
                                        type: object
                                      type: array
                                    setActions:
                                      items:
                                        oneOf:
                                        - not:
                                            anyOf:
                                            - required:
                                              - sourceCluster
                                            - required:
                                              - destinationCluster
                                            - required:
                                              - requestHeaders
                                            - required:
                                              - remoteAddress
                                            - required:
                                              - genericKey
                                            - required:
                                              - headerValueMatch
                                        - required:
                                          - sourceCluster
                                        - required:
                                          - destinationCluster
                                        - required:
                                          - requestHeaders
                                        - required:
                                          - remoteAddress
                                        - required:
                                          - genericKey
                                        - required:
                                          - headerValueMatch
                                        properties:
                                          destinationCluster:
                                            description: Rate limit on destination
                                              cluster.
                                            type: object
                                          genericKey:
                                            description: Rate limit on a generic key.
                                            properties:
                                              descriptorValue:
                                                description: The value to use in the
                                                  descriptor entry.
                                                type: string
                                            type: object
                                          headerValueMatch:
                                            description: Rate limit on the existence
                                              of request headers.
                                            properties:
                                              descriptorValue:
                                                description: The value to use in the
                                                  descriptor entry.
                                                type: string
                                              expectMatch:
                                                description: |-
                                                  If set to true, the action will append a descriptor entry when the
                                                  request matches the headers. If set to false, the action will append a
                                                  descriptor entry when the request does not match the headers. The
                                                  default value is true.
                                                nullable: true
                                                type: boolean
                                              headers:
                                                description: |-
                                                  Specifies a set of headers that the rate limit action should match
                                                  on. The action will check the request’s headers against all the
                                                  specified headers in the config. A match will happen if all the
                                                  headers in the config are present in the request with the same values
                                                  (or based on presence if the value field is not in the config).
                                                items:
                                                  oneOf:
                                                  - not:
                                                      anyOf:
                                                      - required:
                                                        - exactMatch
                                                      - required:
                                                        - regexMatch
                                                      - required:
                                                        - rangeMatch
                                                      - required:
                                                        - presentMatch
                                                      - required:
                                                        - prefixMatch
                                                      - required:
                                                        - suffixMatch
                                                  - required:
                                                    - exactMatch
                                                  - required:
                                                    - regexMatch
                                                  - required:
                                                    - rangeMatch
                                                  - required:
                                                    - presentMatch
                                                  - required:
                                                    - prefixMatch
                                                  - required:
                                                    - suffixMatch
                                                  properties:
                                                    exactMatch:
                                                      description: If specified, header
                                                        match will be performed based
                                                        on the value of the header.
                                                      type: string
                                                    invertMatch:
                                                      description: |-
                                                        If specified, the match result will be inverted before checking. Defaults to false.

                                                        Examples:

                                                        * The regex *\d{3}* does not match the value *1234*, so it will match when inverted.
                                                        * The range [-10,0) will match the value -1, so it will not match when inverted.
                                                      type: boolean
                                                    name:
                                                      description: Specifies the name
                                                        of the header in the request.
                                                      type: string
                                                    prefixMatch:
                                                      description: |-
                                                        If specified, header match will be performed based on the prefix of the header value.
                                                        Note: empty prefix is not allowed, please use present_match instead.

                                                        Examples:

                                                        * The prefix *abcd* matches the value *abcdxyz*, but not for *abcxyz*.
                                                      type: string
                                                    presentMatch:
                                                      description: |-
                                                        If specified, header match will be performed based on whether the header is in the
                                                        request.
                                                      type: boolean
                                                    rangeMatch:
                                                      description: |-
                                                        If specified, header match will be performed based on range.
                                                        The rule will match if the request header value is within this range.
                                                        The entire request header value must represent an integer in base 10 notation: consisting of
                                                        an optional plus or minus sign followed by a sequence of digits. The rule will not match if
                                                        the header value does not represent an integer. Match will fail for empty values, floating
                                                        point numbers or if only a subsequence of the header value is an integer.

                                                        Examples:

                                                        * For range [-10,0), route will match for header value -1, but not for 0, "somestring", 10.9,
                                                          "-1somestring"
                                                      properties:
                                                        end:
                                                          description: end of the
                                                            range (exclusive)
                                                          format: int64
                                                          type: integer
                                                        start:
                                                          description: start of the
                                                            range (inclusive)
                                                          format: int64
                                                          type: integer
                                                      type: object
                                                    regexMatch:
                                                      description: |-
                                                        If specified, this regex string is a regular expression rule which implies the entire request
                                                        header value must match the regex. The rule will not match if only a subsequence of the
                                                        request header value matches the regex. The regex grammar used in the value field is defined
                                                        `(here)[https://en.cppreference.com/w/cpp/regex/ecmascript]`.

                                                        Examples:

                                                        * The regex *\d{3}* matches the value *123*
                                                        * The regex *\d{3}* does not match the value *1234*
                                                        * The regex *\d{3}* does not match the value *123.456*
                                                      type: string
                                                    suffixMatch:
                                                      description: |-
                                                        If specified, header match will be performed based on the suffix of the header value.
                                                        Note: empty suffix is not allowed, please use present_match instead.

                                                        Examples:

                                                        * The suffix *abcd* matches the value *xyzabcd*, but not for *xyzbcd*.
                                                      type: string
                                                  type: object
                                                type: array
                                            type: object
                                          remoteAddress:
                                            description: Rate limit on remote address.
                                            type: object
                                          requestHeaders:
                                            description: Rate limit on request headers.
                                            properties:
                                              descriptorKey:
                                                description: The key to use in the
                                                  descriptor entry.
                                                type: string
                                              headerName:
                                                description: |-
                                                  The header name to be queried from the request headers. The header’s
                                                  value is used to populate the value of the descriptor entry for the
                                                  descriptor_key.
                                                type: string
                                            type: object
                                          sourceCluster:
                                            description: Rate limit on source cluster.
                                            type: object
                                        type: object
                                      type: array
                                  type: object
                                type: array
                            type: object
                          basic:
                            description: Config for rate-limiting using simplified
                              (gloo-specific) API
                            properties:
                              anonymousLimits:
                                description: limits for unauthorized users
                                properties:
                                  requestsPerUnit:
                                    maximum: 4294967295
                                    minimum: 0
                                    type: integer
                                  unit:
                                    enum:
                                    - UNKNOWN
                                    - SECOND
                                    - MINUTE
                                    - HOUR
                                    - DAY
                                    type: string
                                type: object
                              authorizedLimits:
                                description: limits for authorized users
                                properties:
                                  requestsPerUnit:
                                    maximum: 4294967295
                                    minimum: 0
                                    type: integer
                                  unit:
                                    enum:
                                    - UNKNOWN
                                    - SECOND
                                    - MINUTE
                                    - HOUR
                                    - DAY
                                    type: string
                                type: object
                            type: object
                          configRefs:
                            description: |-
                              References to RateLimitConfig resources. This is used to configure the GlooE rate limit server.
                              Only one of `ratelimit` or `rate_limit_configs` can be set.
                            properties:
                              refs:
                                items:
                                  properties:
                                    name:
                                      description: name of the resource being referenced
                                      type: string
                                    namespace:
                                      description: namespace of the resource being
                                        referenced
                                      type: string
                                  type: object
                                type: array
                            type: object
                        type: object
                      requestTimeout:
                        description: Set a timeout on requests.
                        type: string
                      retries:
                        description: Set a retry policy on requests.
                        properties:
                          attempts:
                            description: Number of retries for a given request
                            format: int32
                            type: integer
                          perTryTimeout:
                            description: 'Timeout per retry attempt for a given request.
                              Format: `1h`/`1m`/`1s`/`1ms`. *Must be >= 1ms*.'
                            type: string
                        type: object
                      trafficShift:
                        description: Shift traffic to a different destination.
                        properties:
                          destinations:
                            description: Specify weighted traffic shift destinations.
                            items:
                              oneOf:
                              - not:
                                  anyOf:
                                  - required:
                                    - kubeService
                                  - required:
                                    - virtualDestination
                                  - required:
                                    - staticDestination
                                  - required:
                                    - clusterHeader
                              - required:
                                - kubeService
                              - required:
                                - virtualDestination
                              - required:
                                - staticDestination
                              - required:
                                - clusterHeader
                              properties:
                                clusterHeader:
                                  description: |-
                                    Envoy will determine the cluster to route to by reading the value of the HTTP header named by cluster_header from the request headers.
                                    If the header is not found or the referenced cluster does not exist, Envoy will return a 404 response.
                                    Avoid using this whenever possible, it does not allow for custom filter configuration based on Virtual Host.
                                    {{/* NOTE: unimplemented */}}
                                  type: string
                                kubeService:
                                  description: Specify a Kubernetes Service.
                                  properties:
                                    clusterName:
                                      description: The Gloo Mesh cluster name (registration
                                        name) of the service.
                                      type: string
                                    name:
                                      description: The name of the service.
                                      type: string
                                    namespace:
                                      description: The namespace of the service.
                                      type: string
                                    port:
                                      description: Port on the service to receive
                                        traffic. Required if the service exposes more
                                        than one port.
                                      maximum: 4294967295
                                      minimum: 0
                                      type: integer
                                    subset:
                                      additionalProperties:
                                        type: string
                                      description: Specify, by labels, a subset of
                                        service instances to route to.
                                      type: object
                                  type: object
                                options:
                                  description: |-
                                    additional options / config for a route which will be applied
                                    when this destination is selected.
                                  properties:
                                    headerManipulation:
                                      description: manipualte headers on traffic sent
                                        to this destination
                                      properties:
                                        appendRequestHeaders:
                                          additionalProperties:
                                            type: string
                                          description: Additional HTTP headers to
                                            add before forwarding a request to the
                                            destination service.
                                          type: object
                                        appendResponseHeaders:
                                          additionalProperties:
                                            type: string
                                          description: Additional HTTP headers to
                                            add before returning a response to the
                                            caller.
                                          type: object
                                        removeRequestHeaders:
                                          description: HTTP headers to remove before
                                            forwarding a request to the destination
                                            service.
                                          items:
                                            type: string
                                          type: array
                                        removeResponseHeaders:
                                          description: HTTP headers to remove before
                                            returning a response to the caller.
                                          items:
                                            type: string
                                          type: array
                                      type: object
                                  type: object
                                staticDestination:
                                  description: Reference to a gloo mesh Static Destination
                                  properties:
                                    name:
                                      description: name of the resource being referenced
                                      type: string
                                    namespace:
                                      description: namespace of the resource being
                                        referenced
                                      type: string
                                  type: object
                                virtualDestination:
                                  description: Specify a VirtualDestination.
                                  properties:
                                    name:
                                      description: The name of the VirtualDestination
                                        object.
                                      type: string
                                    namespace:
                                      description: The namespace of the VirtualDestination
                                        object.
                                      type: string
                                    subset:
                                      additionalProperties:
                                        type: string
                                      description: Specify, by labels, a subset of
                                        service instances backing the VirtualDestination
                                        to route to.
                                      type: object
                                  type: object
                                weight:
                                  description: |-
                                    Specify the proportion of traffic to be forwarded to this destination.
                                    Weights across all of the `destinations` must sum to 100.
                                  maximum: 4294967295
                                  minimum: 0
                                  type: integer
                              type: object
                            type: array
                        type: object
                    type: object
                  redirectAction:
                    description: Redirect actions tell the proxy to return a redirect
                      response to the downstream client.
                    properties:
                      hostRedirect:
                        description: The host portion of the URL will be swapped with
                          this value.
                        type: string
                      httpsRedirect:
                        description: The scheme portion of the URL will be swapped
                          with "https".
                        type: boolean
                      pathRedirect:
                        description: The path portion of the URL will be swapped with
                          this value.
                        type: string
                      prefixRewrite:
                        description: |-
                          Indicates that during redirection, the matched prefix (or path)
                          should be swapped with this value. This option allows redirect URLs be dynamically created
                          based on the request.

                            Pay attention to the use of trailing slashes as mentioned in
                            `RouteAction`'s `prefix_rewrite`.
                        type: string
                      responseCode:
                        description: |-
                          The HTTP status code to use in the redirect response. The default response
                          code is MOVED_PERMANENTLY (301).
                        enum:
                        - MOVED_PERMANENTLY
                        - FOUND
                        - SEE_OTHER
                        - TEMPORARY_REDIRECT
                        - PERMANENT_REDIRECT
                        type: string
                      stripQuery:
                        description: |-
                          Indicates that during redirection, the query portion of the URL will
                          be removed. Default value is false.
                        type: boolean
                    type: object
                  routeAction:
                    description: |-
                      This action is the primary action to be selected for most routes. The RouteAction tells the proxy to
                      route requests to an upstream.
                    properties:
                      destinations:
                        description: |-
                          Defines the destination upstream for routing
                          Some destinations require additional configuration for the route (e.g. AWS upstreams require a function name
                          to be specified).
                        items:
                          oneOf:
                          - not:
                              anyOf:
                              - required:
                                - kubeService
                              - required:
                                - virtualDestination
                              - required:
                                - staticDestination
                              - required:
                                - clusterHeader
                          - required:
                            - kubeService
                          - required:
                            - virtualDestination
                          - required:
                            - staticDestination
                          - required:
                            - clusterHeader
                          properties:
                            clusterHeader:
                              description: |-
                                Envoy will determine the cluster to route to by reading the value of the HTTP header named by cluster_header from the request headers.
                                If the header is not found or the referenced cluster does not exist, Envoy will return a 404 response.
                                Avoid using this whenever possible, it does not allow for custom filter configuration based on Virtual Host.
                                {{/* NOTE: unimplemented */}}
                              type: string
                            kubeService:
                              description: Specify a Kubernetes Service.
                              properties:
                                clusterName:
                                  description: The Gloo Mesh cluster name (registration
                                    name) of the service.
                                  type: string
                                name:
                                  description: The name of the service.
                                  type: string
                                namespace:
                                  description: The namespace of the service.
                                  type: string
                                port:
                                  description: Port on the service to receive traffic.
                                    Required if the service exposes more than one
                                    port.
                                  maximum: 4294967295
                                  minimum: 0
                                  type: integer
                                subset:
                                  additionalProperties:
                                    type: string
                                  description: Specify, by labels, a subset of service
                                    instances to route to.
                                  type: object
                              type: object
                            options:
                              description: |-
                                additional options / config for a route which will be applied
                                when this destination is selected.
                              properties:
                                headerManipulation:
                                  description: manipualte headers on traffic sent
                                    to this destination
                                  properties:
                                    appendRequestHeaders:
                                      additionalProperties:
                                        type: string
                                      description: Additional HTTP headers to add
                                        before forwarding a request to the destination
                                        service.
                                      type: object
                                    appendResponseHeaders:
                                      additionalProperties:
                                        type: string
                                      description: Additional HTTP headers to add
                                        before returning a response to the caller.
                                      type: object
                                    removeRequestHeaders:
                                      description: HTTP headers to remove before forwarding
                                        a request to the destination service.
                                      items:
                                        type: string
                                      type: array
                                    removeResponseHeaders:
                                      description: HTTP headers to remove before returning
                                        a response to the caller.
                                      items:
                                        type: string
                                      type: array
                                  type: object
                              type: object
                            staticDestination:
                              description: Reference to a gloo mesh Static Destination
                              properties:
                                name:
                                  description: name of the resource being referenced
                                  type: string
                                namespace:
                                  description: namespace of the resource being referenced
                                  type: string
                              type: object
                            virtualDestination:
                              description: Specify a VirtualDestination.
                              properties:
                                name:
                                  description: The name of the VirtualDestination
                                    object.
                                  type: string
                                namespace:
                                  description: The namespace of the VirtualDestination
                                    object.
                                  type: string
                                subset:
                                  additionalProperties:
                                    type: string
                                  description: Specify, by labels, a subset of service
                                    instances backing the VirtualDestination to route
                                    to.
                                  type: object
                              type: object
                            weight:
                              description: |-
                                Specify the proportion of traffic to be forwarded to this destination.
                                Weights across all of the `destinations` must sum to 100.
                              maximum: 4294967295
                              minimum: 0
                              type: integer
                          type: object
                        type: array
                    type: object
                type: object
              type: array
            weight:
              description: |-
                When multiple route tables are matched by a selector their routes will be sorted together by specificity.
                Giving a route table a weight wil make all its routes take precedence over route tables with a lower weight.
                Weights are only used when a selector is used since the order is not guaranteed. Route tables specified with a
                ref are ordered and will take precedence over any route tables selected via selector.
              format: int32
              type: integer
          type: object
        status:
          properties:
            errors:
              description: Any errors found while processing this generation of the
                resource.
              items:
                type: string
              type: array
            observedGeneration:
              description: |-
                The most recent generation observed in the the RouteTable metadata.
                If the `observedGeneration` does not match `metadata.generation`,
                Gloo Mesh has not processed the most recent version of this resource.
              format: int64
              type: integer
            selectedBy:
              description: List of resources which have selected this RouteTable.
                Can be VirtualHosts or other RouteTables
              items:
                properties:
                  name:
                    description: Name of resource selecting this RouteTable
                    type: string
                  namespace:
                    description: Namespace of resource selecting this RouteTable
                    type: string
                  type:
                    description: |-
                      Type of resource selecting this RouteTable. Can be
                      VirtualGateway, VirtualHost, or RouteTable.
                    type: string
                type: object
              type: array
            selectedRouteTables:
              description: List of child RouteTables that this RouteTable delegates
                to
              items:
                properties:
                  name:
                    description: name of the resource being referenced
                    type: string
                  namespace:
                    description: namespace of the resource being referenced
                    type: string
                type: object
              type: array
            warnings:
              description: Any warnings found while processing this generation of
                the resource.
              items:
                type: string
              type: array
          type: object
      type: object
  versions:
  - name: v1beta1
    served: true
    storage: true

---
apiVersion: apiextensions.k8s.io/v1beta1
kind: CustomResourceDefinition
metadata:
  labels:
    app: gloo-mesh
    app.kubernetes.io/name: gloo-mesh
  name: servicedependencies.networking.enterprise.mesh.gloo.solo.io
spec:
  group: networking.enterprise.mesh.gloo.solo.io
  names:
    kind: ServiceDependency
    listKind: ServiceDependencyList
    plural: servicedependencies
    singular: servicedependency
  preserveUnknownFields: false
  scope: Namespaced
  subresources:
    status: {}
  validation:
    openAPIV3Schema:
      properties:
        spec:
          description: |-
            A ServiceDependency specifies explicit dependencies between traffic sources and destinations in a service graph.
               Depending on the underlying service mesh, explicitly describing dependencies can improve the performance
               of the data plane by pruning away any unneeded networking configuration from the relevant proxies.

               The complete set of service dependencies for a given traffic source is the aggregation of all
               unique Destinations selected by any applicable ServiceDependencies. If a traffic source has no applied
               ServiceDependencies, its service dependency configuration defaults to the behavior of the underlying service mesh.

               Note that in order to block communication between sources and destinations not explicitly declared
               in a ServiceDependency, additional configuration on the underlying service mesh may be required.
               For instance, Istio must be configured with `outboundTrafficPolicy.Mode` set to `REGISTRY_ONLY` (see [here](https://istio.io/latest/docs/reference/config/istio.mesh.v1alpha1/#MeshConfig-OutboundTrafficPolicy))
               to enforce this behavior.
          properties:
            destinationSelectors:
              description: Select the traffic targets (i.e. Destination) for this
                network ServiceDependency. If omitted, selects all Destinations.
              items:
                properties:
                  kubeServiceMatcher:
                    description: Match Kubernetes Services by their labels, namespaces,
                      and/or clusters.
                    properties:
                      clusters:
                        description: |-
                          If specified, match Kubernetes Services if they exist in one of the specified clusters.
                                     When used in a networking policy, omission matches any cluster.
                                     When used in a Gloo Mesh Role, a wildcard (`"*"`) must be specified to match any cluster.
                        items:
                          type: string
                        type: array
                      labels:
                        additionalProperties:
                          type: string
                        description: |-
                          If specified, a match requires all labels to exist on a Kubernetes Service.
                                     When used in a networking policy, omission matches any labels.
                                     When used in a Gloo Mesh Role, a wildcard (`"*"`) must be specified to match any label key and/or value.
                        type: object
                      namespaces:
                        description: |-
                          If specified, match Kubernetes Services if they exist in one of the specified namespaces.
                                     When used in a networking policy, omission matches any namespace.
                                     When used in a Gloo Mesh Role, a wildcard (`"*"`) must be specified to match any namespace.
                        items:
                          type: string
                        type: array
                    type: object
                  kubeServiceRefs:
                    description: Match Kubernetes Services by direct reference.
                    properties:
                      services:
                        description: |-
                          Match Kubernetes Services by direct reference. All fields are required.
                                     When used in a Gloo Mesh Role, a wildcard (`"*"`) must be specified to match any value for the given field.
                        items:
                          properties:
                            clusterName:
                              description: name of the cluster in which the resource
                                exists
                              type: string
                            name:
                              description: name of the resource being referenced
                              type: string
                            namespace:
                              description: namespace of the resource being referenced
                              type: string
                          type: object
                        type: array
                    type: object
                type: object
              type: array
            sourceSelectors:
              description: Select the traffic sources (i.e. Workloads) for this network
                ServiceDependency. If omitted, selects all Workloads.
              items:
                properties:
                  kubeWorkloadMatcher:
                    description: Match Kubernetes workloads by their labels, namespaces,
                      and/or clusters.
                    properties:
                      clusters:
                        description: |-
                          If specified, match Kubernetes workloads if they exist in one of the specified clusters.
                                     When used in a networking policy, omission matches any cluster.
                                     When used in a Gloo Mesh Role, a wildcard (`"*"`) must be specified to match any cluster.
                        items:
                          type: string
                        type: array
                      labels:
                        additionalProperties:
                          type: string
                        description: |-
                          If specified, all labels must exist on Kubernetes workload.
                                 When used in a networking policy, omission matches any labels.
                                 When used in a Gloo Mesh Role, a wildcard (`"*"`) must be specified to match any label key and/or value.
                        type: object
                      namespaces:
                        description: |-
                          If specified, match Kubernetes workloads if they exist in one of the specified namespaces.
                                     When used in a networking policy, omission matches any namespace.
                                     When used in a Gloo Mesh Role, a wildcard (`"*"`) must be specified to match any namespace.
                        items:
                          type: string
                        type: array
                    type: object
                type: object
              type: array
          type: object
        status:
          properties:
            errors:
              description: Any errors found while processing this generation of the
                resource.
              items:
                type: string
              type: array
            observedGeneration:
              description: |-
                The most recent generation observed in the the ServiceDependency metadata.
                If the observedGeneration does not match `metadata.generation`, Gloo Mesh has not processed the most
                recent version of this resource.
              format: int64
              type: integer
            state:
              description: |-
                The state of the overall resource, will only show accepted if it has been successfully
                applied to all exported to Meshes.
              enum:
              - PENDING
              - ACCEPTED
              - INVALID
              - FAILED
              type: string
            workloads:
              additionalProperties:
                properties:
                  acceptanceOrder:
                    description: |-
                      Represents the order in which the policy
                      was accepted and applied to a discovery resource. The first accepted policy
                      will have an acceptance_order of 0, the second 1, etc.
                      When conflicts are detected in the system,
                      the Policy with the lowest acceptance_order
                      will be chosen and all other conflicting policies will be rejected.
                    maximum: 4294967295
                    minimum: 0
                    type: integer
                  errors:
                    description: Any errors observed which prevented the resource
                      from being Accepted.
                    items:
                      type: string
                    type: array
                  state:
                    description: The result of attempting to apply the policy to the
                      discovery resource.
                    enum:
                    - PENDING
                    - ACCEPTED
                    - INVALID
                    - FAILED
                    type: string
                  warnings:
                    description: Any warnings observed while processing the resource.
                    items:
                      type: string
                    type: array
                type: object
              description: |-
                The status of the ServiceDependency for each selected Workload.
                A ServiceDependency may have different statuses for each Workload it applies to.
              type: object
          type: object
      type: object
  versions:
  - name: v1beta1
    served: true
    storage: true
